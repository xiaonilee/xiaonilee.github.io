<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>TensorFlow2 class6: 循环神经网络 - xiaoni&#39;s blog</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="Xiaoni" />
  <meta name="description" content="TensorFlow2 notebook: Class6: 循环神经网络,用基础RNN,LSTM,GRU实现股票预测.
" />

  <meta name="keywords" content="xiaonili, xiaonilee, xiaoni" />






<meta name="generator" content="Hugo 0.79.0" />


<link rel="canonical" href="https://xiaonilee.github.io/post/tensorflow206/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.f1e506a781bf25d33ffc18aa6b4e972a965c58049d27d4f92b7db2e9bf28e4bf.css" integrity="sha256-8eUGp4G/JdM//Biqa06XKpZcWASdJ9T5K32y6b8o5L8=" media="screen" crossorigin="anonymous">



<link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/css/all.css" rel="stylesheet">
<script src="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/js/all.js"></script>




<meta property="og:title" content="TensorFlow2 class6: 循环神经网络" />
<meta property="og:description" content="TensorFlow2 notebook: Class6: 循环神经网络,用基础RNN,LSTM,GRU实现股票预测." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xiaonilee.github.io/post/tensorflow206/" />
<meta property="article:published_time" content="2020-12-13T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-12-17T00:00:00+00:00" />
<meta itemprop="name" content="TensorFlow2 class6: 循环神经网络">
<meta itemprop="description" content="TensorFlow2 notebook: Class6: 循环神经网络,用基础RNN,LSTM,GRU实现股票预测.">
<meta itemprop="datePublished" content="2020-12-13T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-12-17T00:00:00+00:00" />
<meta itemprop="wordCount" content="2844">



<meta itemprop="keywords" content="TensorFlow2,ML," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="TensorFlow2 class6: 循环神经网络"/>
<meta name="twitter:description" content="TensorFlow2 notebook: Class6: 循环神经网络,用基础RNN,LSTM,GRU实现股票预测."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-177860608-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Xiaoni's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/">Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/post/">Archives</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/categories/">Categories</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/tags/">Tags</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/about/">About Me</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          <div class="mobile-menu-parent">
            <span class="mobile-submenu-open"></span>
            <a href="https://xiaonilee.github.io/">
              docs
            </a>
          </div>
          <ul class="mobile-submenu-list">
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow2/"> ML Notebook: TensorFlow2</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/rinactionmap/">Book: R in Action</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tumorimmune/">Comprehensive Bioinformatics Analysis of Tumor-Infiltrating Immune Cells</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/firebrowse/">FireBrowse Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gdc/">GDC Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gscalite/">GSCALite: Gene Set Cancer Analysis</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/frontoncol/">Identification of Therapeutic Targets and Prognostic Biomarkers Among CXC Chemokines in the Renal Cell Carcinoma Microenvironment</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/localxenadatahub/">Local UCSC Xena Data Hub</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/oncolnc/">OncoLnc: A straightforward Tool</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/hmwk10/">R Notebook : Application Exercises</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/ggplot2/">R Notebook : ggplot2</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tricktcga/">R re-analysis in TCGA</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tissgdb/">TissGDB: tissue-specific gene database in cancer</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/genomicsignatures/">UCSC Xena Features: Genomic Signatures</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/loaddata/">UCSC Xena: Load Data From Public Database</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/privatepublictogether/">UCSC Xena: Private and Public Data Put Together</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/webfrontend/">web front end</a>
              </li>
            
          </ul>
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Xiaoni's Blog
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/">Home</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/post/">Archives</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/categories/">Categories</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/tags/">Tags</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/about/">About Me</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          <a class="menu-item-link menu-parent" href="https://xiaonilee.github.io/">docs</a>
          <ul class="submenu" >
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow2/"> ML Notebook: TensorFlow2</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/rinactionmap/">Book: R in Action</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tumorimmune/">Comprehensive Bioinformatics Analysis of Tumor-Infiltrating Immune Cells</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/firebrowse/">FireBrowse Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gdc/">GDC Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gscalite/">GSCALite: Gene Set Cancer Analysis</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/frontoncol/">Identification of Therapeutic Targets and Prognostic Biomarkers Among CXC Chemokines in the Renal Cell Carcinoma Microenvironment</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/localxenadatahub/">Local UCSC Xena Data Hub</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/oncolnc/">OncoLnc: A straightforward Tool</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/hmwk10/">R Notebook : Application Exercises</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/ggplot2/">R Notebook : ggplot2</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tricktcga/">R re-analysis in TCGA</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tissgdb/">TissGDB: tissue-specific gene database in cancer</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/genomicsignatures/">UCSC Xena Features: Genomic Signatures</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/loaddata/">UCSC Xena: Load Data From Public Database</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/privatepublictogether/">UCSC Xena: Private and Public Data Put Together</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/webfrontend/">web front end</a>
              </li>
            
          </ul>

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">TensorFlow2 class6: 循环神经网络</h1>
      
      <div class="post-meta">
        <time datetime="2020-12-13" class="post-time">
          2020-12-13
        </time>
        <div class="post-category">
            <a href="https://xiaonilee.github.io/categories/tensorflow2/"> TensorFlow2 </a>
            <a href="https://xiaonilee.github.io/categories/ml/"> ML </a>
            <a href="https://xiaonilee.github.io/categories/big-data/"> big data </a>
            
          </div>
        

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Table of Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#in-summary">In summary</a>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#60-回顾">6.0 回顾</a></li>
        <li><a href="#61-循环核">6.1 循环核</a></li>
        <li><a href="#62-循环核时间步展开">6.2 循环核时间步展开</a></li>
        <li><a href="#63-循环计算层">6.3 循环计算层</a></li>
        <li><a href="#64-tf描述循环计算层">6.4 TF描述循环计算层</a></li>
        <li><a href="#65-循环计算过程i">6.5 循环计算过程I</a></li>
        <li><a href="#66-字母预测onehot_1pre1">6.6 字母预测onehot_1pre1</a></li>
        <li><a href="#67-循环计算过程ii">6.7 循环计算过程II</a></li>
        <li><a href="#68-字母预测onehot_4pre1">6.8 字母预测onehot_4pre1</a></li>
        <li><a href="#69-embedding编码">6.9 Embedding编码</a></li>
        <li><a href="#610-字母预测embedding_1pre1">6.10 字母预测Embedding_1pre1</a></li>
        <li><a href="#611-字母预测embedding_4pre1">6.11 字母预测Embedding_4pre1</a></li>
        <li><a href="#612-rnn实现股票预测">6.12 RNN实现股票预测</a></li>
        <li><a href="#600-半讲小结">6.00 半讲小结</a></li>
        <li><a href="#613-lstm实现股票预测lstm计算过程_tf描述lstm层">6.13 LSTM实现股票预测(LSTM计算过程_TF描述LSTM层)</a></li>
        <li><a href="#614-gru实现股票预测gru计算过程_tf描述gru层">6.14 GRU实现股票预测(GRU计算过程_TF描述GRU层)</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <p>TensorFlow2 notebook: Class6: 循环神经网络,用基础RNN,LSTM,GRU实现股票预测.</p>
<h2 id="in-summary">In summary</h2>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>Setup virtul environment</li>
<li><code>python3.6.9</code> + <code>TensorFlow2.3.0</code> + <code>sklearn</code> + <code>pandas</code> + <code>matplotlib</code></li>
</ul>
<h3 id="60-回顾">6.0 回顾</h3>
<ul>
<li><strong>卷积神经网络:</strong>
<ul>
<li>卷积
<ul>
<li>特征提取器, CBAPD</li>
</ul>
</li>
<li>卷积神经网络
<ul>
<li>借助<strong>卷积核</strong>提取<strong>空间特征</strong>后，送入全连接网络, 实现离散数据的分类</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="61-循环核">6.1 循环核</h3>
<ul>
<li>具有记忆力</li>
<li><strong>不同时刻的参数</strong>共享, 实现了对时间序列的信息提取</li>
<li>$$输入指定维度的x_t\ 输出指定维度的y_t\ $$</li>
<li>$$n个记忆体内存储的状态信息h_t\  + 下面待训练参数矩阵 w_{xh}\  + 周围侧面待训练参数矩阵 w_{hh}\ + 上面待训练参数矩阵w_{hy}\ $$
<ul>
<li>前向传播时: $$h_t\ 在每个时刻都被刷新，w_{xh}\ w_{hh}\ w_{hy}\ 自始至终都固定不变$$</li>
<li>反向传播时: $$x_h\ w_{hh}\ w_{hy}\ 被梯度下降法更新$$</li>
<li>$$h_t = 激活函数tanh(x_tw_{xh} + h_{t-1}w_{hh} + bh)\ $$</li>
<li>$$y_t = 激活函数softmax(h_tw_{hy}+by)\ 是循环网络末层, 是一层全连接$$</li>
</ul>
</li>
</ul>
<h3 id="62-循环核时间步展开">6.2 循环核时间步展开</h3>
<ul>
<li>将循环核按时间步展开, 按照时间轴方向展开t步: $$x_0\ \ x_1\ \ x_2\ \ &hellip; x_{t-1} \ \ x_t\ $$</li>
<li>$$每个时刻h_t 被刷新,记忆体周围的参数矩阵w_{xh}  + w_{hh} + w_{hy} 固定不变(类似于人脑中的记忆体, 每个时刻会根据当前的输入而更新, 当前时刻的推理是根据以往的知识积累, 用固化下来的参数矩阵进行推理判断), 进行训练优化, 得到最好的参数矩阵, 进行前向传播, 输出连续数据的预测结果$$</li>
</ul>
<h3 id="63-循环计算层">6.3 循环计算层</h3>
<ul>
<li><strong>每个</strong>循环核构成一<strong>层</strong>循环计算层
<ul>
<li>每个循环核中<strong>记忆体的个数</strong>, 可以根据需求<strong>任意指定</strong></li>
</ul>
</li>
<li>层数是向输出方向增长的</li>
</ul>
<h3 id="64-tf描述循环计算层">6.4 TF描述循环计算层</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">SimpleRNN</span><span class="p">(</span><span class="err">记忆体个数，</span><span class="n">activation</span><span class="o">=</span><span class="err">‘激活函数’</span><span class="p">,</span> 
<span class="n">return_sequences</span><span class="o">=</span><span class="err">是否每个时刻输出</span><span class="n">ht到下一层</span><span class="p">)</span>
<span class="n">activation</span><span class="o">=</span><span class="err">‘激活函数’</span> <span class="p">(</span><span class="err">不写，默认使用</span><span class="n">tanh</span><span class="p">)</span> 
<span class="n">return_sequences</span><span class="o">=</span><span class="bp">True</span> <span class="err">循环核各时刻会把</span><span class="n">ht推送到到下一层</span>
<span class="n">return_sequences</span><span class="o">=</span><span class="bp">False</span> <span class="err">循环核仅在最后一个时刻把</span><span class="n">ht推送到到下一层</span><span class="p">(</span><span class="err">默认</span><span class="p">)</span>

<span class="err">例</span><span class="p">:</span><span class="n">SimpleRNN</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>送入RNN时， 要求x_train维度是3维:
<ul>
<li>[送入样本个数, 循环核时间展开步的步数, 每个时间步输入特征个数]</li>
</ul>
</li>
</ul>
<h3 id="65-循环计算过程i">6.5 循环计算过程I</h3>
<ul>
<li>字母预测
<ul>
<li>目标: 输入a预测出b，输入b预测出c， 输入c预测出d，输入d预测出e，输入e预测出a</li>
<li>将a b c d e用数字表示出来: 独热码进行编码
<ul>
<li>a: 10000</li>
<li>b: 01000</li>
<li>c: 00100</li>
<li>d: 00010</li>
<li>e: 00001</li>
</ul>
</li>
<li>$$随机生成w_{xh}  \ \ w_{hh} \ \ w_{hy} 三参数的矩阵值$$</li>
<li>记忆体个数设为: $$3$$</li>
<li>上一时刻, 起始时刻的记忆体信息: $$ h_{t-1}=0$$</li>
<li>$$代入随机生成的三参数数值和初始h_{t-1}值,计算当前时刻的h_t = tanh(x_tw_{xh} + h_{t-1}w_{hh} + bh), 将记忆体存储的状态信息进行更新$$</li>
<li>$$将得到的h_t矩阵值代入公式softmax(h_tw_{hy}+by) \ 预测出y_t结果, 概率最大的即为结果$$</li>
</ul>
</li>
</ul>
<h3 id="66-字母预测onehot_1pre1">6.6 字母预测onehot_1pre1</h3>
<ul>
<li>RNN实现连续输入1个字母预测下一个字母</li>
<li>字母进行独热码编码one hot</li>
<li><a href="606/rnn_onehot_1pre1.ckpt.index">rnn_onehot_1pre1.ckpt.index</a></li>
<li><a href="606/rnn_onehot_1pre1.ckpt.data-00000-of-00001">rnn_onehot_1pre1.ckpt.data-00000-of-00001</a></li>
<li><a href="606/checkpoint">checkpoint</a></li>
<li><a href="606/weights.txt">weights</a></li>
</ul>
<h3 id="67-循环计算过程ii">6.7 循环计算过程II</h3>
<ul>
<li>连续输入4个(多个)字母, 预测下一个字母</li>
<li>使用3个记忆体, 初始时刻为[0 0 0], 每个时间步之后被计算依次更新</li>
<li>每个时间步具有相同的$$w_{xh}  \ \ w_{hh} \ \ bh $$</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># 矩阵计算过程</span>
<span class="n">xtb</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> <span class="n">nrow</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="m">5</span><span class="p">,</span> <span class="n">byrow</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">xtc</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> <span class="n">nrow</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="m">5</span><span class="p">,</span> <span class="n">byrow</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">xtd</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> <span class="n">nrow</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="m">5</span><span class="p">,</span> <span class="n">byrow</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">xte</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="n">nrow</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="m">5</span><span class="p">,</span> <span class="n">byrow</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">ht1</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-0.9</span><span class="p">,</span> <span class="m">0.2</span><span class="p">,</span> <span class="m">0.2</span><span class="p">),</span> <span class="n">nrow</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">byrow</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
<span class="n">ht2</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0.8</span><span class="p">,</span> <span class="m">1.0</span><span class="p">,</span> <span class="m">0.8</span><span class="p">),</span> <span class="n">nrow</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">byrow</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
<span class="n">ht3</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0.6</span><span class="p">,</span> <span class="m">0.5</span><span class="p">,</span> <span class="m">-1.0</span><span class="p">),</span> <span class="n">nrow</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">byrow</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
<span class="n">ht4</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-1.0</span><span class="p">,</span> <span class="m">-1.0</span><span class="p">,</span> <span class="m">0.8</span><span class="p">),</span> <span class="n">nrow</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">byrow</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="n">whh</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-0.9</span><span class="p">,</span><span class="m">-0.9</span><span class="p">,</span><span class="m">-0.9</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="m">0.9</span><span class="p">,</span><span class="m">-0.3</span><span class="p">,</span><span class="m">1.0</span><span class="p">,</span><span class="m">0.3</span><span class="p">,</span><span class="m">-1.5</span><span class="p">),</span> 
              <span class="n">nrow</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">byrow</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="n">wxh</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1.2</span><span class="p">,</span><span class="m">-1.3</span><span class="p">,</span><span class="m">1.1</span><span class="p">,</span><span class="m">-1.5</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.3</span><span class="p">,</span><span class="m">-0.3</span><span class="p">,</span><span class="m">1.7</span><span class="p">,</span><span class="m">0.7</span><span class="p">,</span><span class="m">-0.1</span><span class="p">,</span><span class="m">0.1</span><span class="p">,</span><span class="m">-0.1</span><span class="p">,</span><span class="m">-1.2</span><span class="p">,</span><span class="m">-1.5</span><span class="p">,</span><span class="m">0.3</span><span class="p">),</span> 
              <span class="n">nrow</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">byrow</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="n">wyt</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-1.3</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="m">-0.7</span><span class="p">,</span><span class="m">-0.2</span><span class="p">,</span><span class="m">0.8</span><span class="p">,</span> <span class="m">-1.4</span><span class="p">,</span><span class="m">-0.8</span><span class="p">,</span><span class="m">-1.2</span><span class="p">,</span><span class="m">0.9</span><span class="p">,</span><span class="m">1.4</span><span class="p">,</span><span class="m">0.7</span><span class="p">,</span><span class="m">1.1</span><span class="p">,</span><span class="m">-1.2</span><span class="p">,</span><span class="m">1.3</span><span class="p">,</span><span class="m">-1.1</span><span class="p">),</span> 
              <span class="n">nrow</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">byrow</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="n">xtb</span> <span class="o">%*%</span> <span class="n">wxh</span>
<span class="n">xtc</span> <span class="o">%*%</span> <span class="n">wxh</span>
<span class="n">xtd</span> <span class="o">%*%</span> <span class="n">wxh</span>
<span class="n">xte</span> <span class="o">%*%</span> <span class="n">wxh</span>

<span class="nf">round</span><span class="p">(</span><span class="n">ht1</span> <span class="o">%*%</span> <span class="n">whh</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="nf">round</span><span class="p">(</span><span class="n">ht2</span> <span class="o">%*%</span> <span class="n">whh</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="nf">round</span><span class="p">(</span><span class="n">ht3</span> <span class="o">%*%</span> <span class="n">whh</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="nf">round</span><span class="p">(</span><span class="n">ht4</span> <span class="o">%*%</span> <span class="n">wyt</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="68-字母预测onehot_4pre1">6.8 字母预测onehot_4pre1</h3>
<ul>
<li>RNN实现连续输入4个字母预测下一个字母
<ul>
<li>输入abcd输出e</li>
<li>输入bcde输出a</li>
<li>输入cdea输出b</li>
<li>输入deab输出c</li>
<li>输入eabc输出d</li>
</ul>
</li>
<li>字母进行独热码编码one hot</li>
</ul>
<h4 id="681-交互式输出字母预测结果">6.8.1 交互式输出字母预测结果</h4>
<ul>
<li><a href="608_1/rnn_onehot_4pre1.ckpt.index">rnn_onehot_4pre1.ckpt.index</a></li>
<li><a href="608_1/rnn_onehot_4pre1.ckpt.data-00000-of-00001">rnn_onehot_4pre1.ckpt.data-00000-of-00001</a></li>
<li><a href="608_1/checkpoint">checkpoint</a></li>
<li><a href="608_1/weights.txt">weights</a></li>
</ul>
<h4 id="682-一次性输出字母预测结果">6.8.2 一次性输出字母预测结果</h4>
<ul>
<li><a href="608_2/rnn_onehot_4pre1.ckpt.index">rnn_onehot_4pre1.ckpt.index</a></li>
<li><a href="608_2/rnn_onehot_4pre1.ckpt.data-00000-of-00001">rnn_onehot_4pre1.ckpt.data-00000-of-00001</a></li>
<li><a href="608_2/checkpoint">checkpoint</a></li>
<li><a href="608_2/weights.txt">weights</a></li>
</ul>
<h3 id="69-embedding编码">6.9 Embedding编码</h3>
<ul>
<li>
<p>前面用到的独热码位宽要与词汇量一致</p>
</li>
<li>
<p>Embeddig是一种单词编码方法</p>
</li>
<li>
<p>用低维向量实现了编码</p>
</li>
<li>
<p>编码通过神经网络训练优化，能表达出单词间的相关性</p>
</li>
<li>
<p>tf函数表示</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python">  <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="err">词汇表大小，编码维度</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>x_train 要求维度格式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="p">[</span><span class="err">送入样本数，</span> <span class="err">循环核时间展开步数</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="610-字母预测embedding_1pre1">6.10 字母预测Embedding_1pre1</h3>
<ul>
<li>RNN实现连续输入1个字母预测下一个字母</li>
<li>Embedding编码</li>
</ul>
<h4 id="6101-交互式输出字母预测结果">6.10.1 交互式输出字母预测结果</h4>
<ul>
<li><a href="610_1/run_embedding_1pre1.ckpt.index">run_embedding_1pre1.ckpt.index</a></li>
<li><a href="610_1/run_embedding_1pre1.ckpt.data-00000-of-00001">run_embedding_1pre1.ckpt.data-00000-of-00001</a></li>
<li><a href="610_1/checkpoint">checkpoint</a></li>
<li><a href="610_1/weights.txt">weights</a></li>
</ul>
<h4 id="6102-一次性输出字母预测结果">6.10.2 一次性输出字母预测结果</h4>
<ul>
<li><a href="610_2/run_embedding_1pre1.ckpt.index">run_embedding_1pre1.ckpt.index</a></li>
<li><a href="610_2/run_embedding_1pre1.ckpt.data-00000-of-00001">run_embedding_1pre1.ckpt.data-00000-of-00001</a></li>
<li><a href="610_2/checkpoint">checkpoint</a></li>
<li><a href="610_2/weights.txt">weights</a></li>
</ul>
<h3 id="611-字母预测embedding_4pre1">6.11 字母预测Embedding_4pre1</h3>
<ul>
<li>RNN实现连续输入4个字母预测下一个字母</li>
<li>Embedding编码</li>
<li>词汇量26个</li>
<li>字母a-&gt;z用数字0-25依次一一进行表示</li>
<li>for loop 构建<code>x_train</code> <code>y_train</code>
<ul>
<li>从数字列表中把连续4个数作为输入特征x_train</li>
<li>第5个数作为标签y_train</li>
</ul>
</li>
</ul>
<h4 id="6111-交互式输出字母预测结果">6.11.1 交互式输出字母预测结果</h4>
<ul>
<li><a href="611_1/rnn_embedding_4pre1.ckpt.index">rnn_embedding_4pre1.ckpt.index</a></li>
<li><a href="611_1/run_embedding_4pre1.ckpt.data-00000-of-00001">rnn_embedding_4pre1.ckpt.data-00000-of-00001</a></li>
<li><a href="611_1/checkpoint">checkpoint</a></li>
<li><a href="611_1/weights.txt">weights</a></li>
</ul>
<h4 id="6112-一次性输出字母预测结果">6.11.2 一次性输出字母预测结果</h4>
<ul>
<li><a href="611_2/rnn_embedding_4pre1.ckpt.index">rnn_embedding_4pre1.ckpt.index</a></li>
<li><a href="611_2/run_embedding_4pre1.ckpt.data-00000-of-00001">rnn_embedding_4pre1.ckpt.data-00000-of-00001</a></li>
<li><a href="611_2/checkpoint">checkpoint</a></li>
<li><a href="611_2/weights.txt">weights</a></li>
</ul>
<h3 id="612-rnn实现股票预测">6.12 RNN实现股票预测</h3>
<ul>
<li>
<p>数据源<a href="SH600519.csv">SH600519.csv</a></p>
</li>
<li>
<p>数据下载源码p37_tushare.py</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">tushare</span> <span class="kn">as</span> <span class="nn">ts</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">get_k_data</span><span class="p">(</span><span class="s1">&#39;600519&#39;</span><span class="p">,</span> <span class="n">ktype</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">&#39;2010-04-26&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;2020-04-26&#39;</span><span class="p">)</span>

<span class="n">datapath1</span> <span class="o">=</span> <span class="s2">&#34;./SH600519.csv&#34;</span>
<span class="n">df1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">datapath1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>结果文件</p>
<ul>
<li><a href="612/rnn_stock.ckpt.index">rnn_stock.ckpt.index</a></li>
<li><a href="612/rnn_stock.ckpt.data-00000-of-00001">rnn_stock.ckpt.data-00000-of-00001</a></li>
<li><a href="612/checkpoint">checkpoint</a></li>
<li><a href="612/weights.txt">weights</a></li>
</ul>
</li>
</ul>
<h3 id="600-半讲小结">6.00 半讲小结</h3>
<ul>
<li>上述传统循环网络RNN
<ul>
<li>通过记忆体实现短期记忆, 来进行连续数据的预测</li>
<li>若连续数据序列变长时, 会使<strong>展开时间步</strong>过长, 在反向传播更新参数时,梯度要按照<strong>时间步连续相乘</strong>而导致梯度消失</li>
</ul>
</li>
</ul>
<h3 id="613-lstm实现股票预测lstm计算过程_tf描述lstm层">6.13 LSTM实现股票预测(LSTM计算过程_TF描述LSTM层)</h3>
<ul>
<li>
<p>于1997年提出，通过门控单元改善了RNN长期依赖问题</p>
</li>
<li>
<p>长短记忆网络LONG SHORT-TERM MEMORY</p>
</li>
<li>
<p><strong>3门限</strong></p>
<ul>
<li>输入门(门限)</li>
<li>遗忘门(门限)</li>
<li>输出门(门限)</li>
<li>$$当前时刻输入特征x_t, 上一时刻的短期记忆函数h_{t-1},输入门 i_t, 遗忘门f_t, 输出门o_t三门中各自待训练参数矩阵W_i, W_f, w_o, 与相应的待训练偏置项b_i,b_f,b_o,\ 各自经过sigmoid函数$$</li>
<li>门限范围0-1</li>
</ul>
</li>
<li>
<p><strong>细胞态</strong>,由过去的长期记忆+现在的候选态构成</p>
<ul>
<li>$$表示长期记忆c_t$$</li>
<li>上一时刻的长期记忆(过去的长期记忆) x 遗忘门 + 当前时刻归纳出的新知识(候选态) x 输入门</li>
</ul>
</li>
<li>
<p><strong>记忆体</strong>的输出, 是长期记忆的一部分</p>
<ul>
<li>$$表示短期记忆h_t$$</li>
<li>细胞态经过tanh激活函数后(留存在脑中的长期记忆) x 输出门</li>
</ul>
</li>
<li>
<p><strong>候选态</strong></p>
<ul>
<li>等待存入长期记忆, 归纳出的新知识</li>
</ul>
</li>
<li>
<p>TF描述LSTM层</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="err">记忆体个数，</span><span class="n">return_sequences</span><span class="o">=</span><span class="err">是否返回输出</span><span class="p">)</span>
<span class="n">return_sequences</span><span class="o">=</span><span class="bp">True</span> <span class="err">各时间步输出</span><span class="n">ht</span><span class="p">,</span><span class="err">多用于中间层网络</span>
<span class="n">return_sequences</span><span class="o">=</span><span class="bp">False</span> <span class="err">仅最后时间步输出</span><span class="n">ht</span><span class="p">(</span><span class="err">默认</span><span class="p">),</span> <span class="err">多用于最后一层网络</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>结果文件</p>
<ul>
<li><a href="613/LSTM_stock.ckpt.index">LSTM_stock.ckpt.index</a></li>
<li><a href="613/LSTM_stock.ckpt.data-00000-of-00001">LSTM_stock.ckpt.data-00000-of-00001</a></li>
<li><a href="613/checkpoint">checkpoint</a></li>
<li><a href="613/weights.txt">weights</a></li>
</ul>
</li>
</ul>
<h3 id="614-gru实现股票预测gru计算过程_tf描述gru层">6.14 GRU实现股票预测(GRU计算过程_TF描述GRU层)</h3>
<ul>
<li>
<p>GRU网络于2014年提出，优化LSTM结构</p>
</li>
<li>
<p>两门</p>
<ul>
<li>$$更新门z_t$$</li>
<li>$$重置门r_t$$</li>
<li>门限范围0-1</li>
</ul>
</li>
<li>
<p>$$ 记忆体h_t融合了长期记忆和短期记忆$$</p>
</li>
<li>
<p>$$ 上一时刻记忆体 x (1-更新门) + 候选隐藏层 x 更新门$$</p>
</li>
<li>
<p>$$候选隐藏层取决于上一时刻记忆体 * 重置门以及当前输入特征x_t$$</p>
</li>
<li>
<p>TF描述GRU层</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">GRU</span><span class="p">(</span><span class="err">记忆体个数，</span><span class="n">return_sequences</span><span class="o">=</span><span class="err">是否返回输出</span><span class="p">)</span> <span class="n">return_sequences</span><span class="o">=</span><span class="bp">True</span> <span class="err">各时间步输出</span><span class="n">ht</span>
<span class="n">return_sequences</span><span class="o">=</span><span class="bp">False</span> <span class="err">仅最后时间步输出</span><span class="n">ht</span><span class="p">(</span><span class="err">默认</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>结果文件</p>
<ul>
<li><a href="614/stock.ckpt.index">stock.ckpt.index</a></li>
<li><a href="614/stock.ckpt.data-00000-of-00001">stock.ckpt.data-00000-of-00001</a></li>
<li><a href="614/checkpoint">checkpoint</a></li>
<li><a href="614/weights.txt">weights</a></li>
</ul>
</li>
</ul>
<p>Attach is the file of <a href="TensorFlow2class6.ipynb">TensorFlow2class6.ipynb</a>, or view it via the <a href="https://colab.research.google.com/drive/1NJgM3NG0igL-zTx3k-EkNk0-7rR5ES9K?usp=sharing">link</a>.</p>
<p>Show me the code <i class="far fa-hand-point-down"></i></p>
<p><a href="https://gist.github.com/xiaonilee/0f5034da455136055559511a9bfe23e9"><img src="fig2.png" alt="fig2"></a>
<a href="https://gist.github.com/xiaonilee/0f5034da455136055559511a9bfe23e9"><img src="fig3.png" alt="fig3"></a></p>
<script type="text/javascript" src="http://gist.github.com/0f5034da455136055559511a9bfe23e9.js"></script>
    </div>

    
    


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://xiaonilee.github.io/tags/tensorflow2/">TensorFlow2</a>
          <a href="https://xiaonilee.github.io/tags/ml/">ML</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/tensorflow2/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default"> ML Notebook: TensorFlow2</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="/post/tensorflow205/">
            <span class="next-text nav-default">TensorFlow2 class5: 卷积神经网络</span>
            <span class="prev-text nav-mobile">Next</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:xiaoni0601@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/xiaonilee" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="https://xiaonilee.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">

  <span class="copyright-year">
    &copy;
    
      2020 -
    2021
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        xiaonilee
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>



  <script type="text/javascript">
    window.MathJax = {
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script>









  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  















</body>
</html>
