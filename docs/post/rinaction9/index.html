<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 9. Analysis of variance - xiaoni&#39;s blog</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="Xiaoni" />
  <meta name="description" content="Notebook of Reading Books: R in Action_Chapter 9.
" />

  <meta name="keywords" content="xiaonili, xiaonilee, xiaoni" />






<meta name="generator" content="Hugo 0.79.0" />


<link rel="canonical" href="https://xiaonilee.github.io/post/rinaction9/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.f1e506a781bf25d33ffc18aa6b4e972a965c58049d27d4f92b7db2e9bf28e4bf.css" integrity="sha256-8eUGp4G/JdM//Biqa06XKpZcWASdJ9T5K32y6b8o5L8=" media="screen" crossorigin="anonymous">



<link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/css/all.css" rel="stylesheet">
<script src="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/js/all.js"></script>




<meta property="og:title" content="Chapter 9. Analysis of variance" />
<meta property="og:description" content="Notebook of Reading Books: R in Action_Chapter 9." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xiaonilee.github.io/post/rinaction9/" />
<meta property="article:published_time" content="2020-10-30T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-10-30T00:00:00+00:00" />
<meta itemprop="name" content="Chapter 9. Analysis of variance">
<meta itemprop="description" content="Notebook of Reading Books: R in Action_Chapter 9.">
<meta itemprop="datePublished" content="2020-10-30T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-10-30T00:00:00+00:00" />
<meta itemprop="wordCount" content="2509">



<meta itemprop="keywords" content="R,R in Action,Bioinformatics,Book," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Chapter 9. Analysis of variance"/>
<meta name="twitter:description" content="Notebook of Reading Books: R in Action_Chapter 9."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-177860608-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Xiaoni's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/">Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/post/">Archives</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/categories/">Categories</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/tags/">Tags</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/about/">About Me</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          <div class="mobile-menu-parent">
            <span class="mobile-submenu-open"></span>
            <a href="https://xiaonilee.github.io/">
              docs
            </a>
          </div>
          <ul class="mobile-submenu-list">
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow2/"> ML Notebook: TensorFlow2</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/rinactionmap/">Book: R in Action</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/firebrowse/">FireBrowse Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gdc/">GDC Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gscalite/">GSCALite: Gene Set Cancer Analysis</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/localxenadatahub/">Local UCSC Xena Data Hub</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/oncolnc/">OncoLnc: A straightforward Tool</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/hmwk10/">R Notebook : Application Exercises</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/ggplot2/">R Notebook : ggplot2</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tricktcga/">R re-analysis in TCGA</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow205/">TensorFlow2 class5: 卷积神经网络</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tissgdb/">TissGDB: tissue-specific gene database in cancer</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/genomicsignatures/">UCSC Xena Features: Genomic Signatures</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/loaddata/">UCSC Xena: Load Data From Public Database</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/privatepublictogether/">UCSC Xena: Private and Public Data Put Together</a>
              </li>
            
          </ul>
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Xiaoni's Blog
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/">Home</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/post/">Archives</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/categories/">Categories</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/tags/">Tags</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/about/">About Me</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          <a class="menu-item-link menu-parent" href="https://xiaonilee.github.io/">docs</a>
          <ul class="submenu" >
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow2/"> ML Notebook: TensorFlow2</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/rinactionmap/">Book: R in Action</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/firebrowse/">FireBrowse Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gdc/">GDC Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gscalite/">GSCALite: Gene Set Cancer Analysis</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/localxenadatahub/">Local UCSC Xena Data Hub</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/oncolnc/">OncoLnc: A straightforward Tool</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/hmwk10/">R Notebook : Application Exercises</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/ggplot2/">R Notebook : ggplot2</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tricktcga/">R re-analysis in TCGA</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow205/">TensorFlow2 class5: 卷积神经网络</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tissgdb/">TissGDB: tissue-specific gene database in cancer</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/genomicsignatures/">UCSC Xena Features: Genomic Signatures</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/loaddata/">UCSC Xena: Load Data From Public Database</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/privatepublictogether/">UCSC Xena: Private and Public Data Put Together</a>
              </li>
            
          </ul>

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Chapter 9. Analysis of variance</h1>
      
      <div class="post-meta">
        <time datetime="2020-10-30" class="post-time">
          2020-10-30
        </time>
        <div class="post-category">
            <a href="https://xiaonilee.github.io/categories/r/"> R </a>
            <a href="https://xiaonilee.github.io/categories/bioinformatics/"> Bioinformatics </a>
            
          </div>
        

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Table of Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#this-chapter-covers">This chapter covers</a>
      <ul>
        <li><a href="#91-a-crash-course-on-terminology">9.1. A crash course on terminology</a></li>
        <li><a href="#92-fitting-anova-models">9.2. Fitting ANOVA models</a></li>
        <li><a href="#93-one-way-anova">9.3. One-way ANOVA</a></li>
        <li><a href="#94-one-way-ancova">9.4. One-way ANCOVA</a></li>
        <li><a href="#95-two-way-factorial-anova">9.5. Two-way factorial ANOVA</a></li>
        <li><a href="#96-repeated-measures-anova">9.6. Repeated measures ANOVA</a></li>
        <li><a href="#97-multivariate-analysis-of-variance-manova">9.7. Multivariate analysis of variance (MANOVA)</a></li>
        <li><a href="#98-anova-as-regression">9.8. ANOVA as regression</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <p>Notebook of Reading Books: R in Action_Chapter 9.</p>
<h2 id="this-chapter-covers">This chapter covers</h2>
<ul>
<li>
<p>Using R to model basic experimental designs</p>
</li>
<li>
<p>Fitting and interpreting ANOVA type models</p>
</li>
<li>
<p>Evaluating model assumptions</p>
</li>
</ul>
<h3 id="91-a-crash-course-on-terminology">9.1. A crash course on terminology</h3>
<ul>
<li>ANOVA
<ul>
<li>F test</li>
</ul>
</li>
</ul>
<h3 id="92-fitting-anova-models">9.2. Fitting ANOVA models</h3>
<h4 id="921-the-aov-function">9.2.1. The aov() function</h4>
<p><img src="tab94.png" alt="tab94"></p>
<h4 id="922-the-order-of-formula-terms">9.2.2. The order of formula terms</h4>
<ul>
<li>
<p>with <code>Type I</code> (sequential), by default.</p>
</li>
<li>
<p><code>help(Anova, package=&quot;car&quot;)</code></p>
</li>
</ul>
<h3 id="93-one-way-anova">9.3. One-way ANOVA</h3>
<ul>
<li>
<p>Figure 9.1. <strong>Treatment group means</strong> with <strong>95 percent confidence intervals</strong> for five cholesterol-reducing drug regiments.</p>
<p><img src="fig91.png" alt="fig91"></p>
</li>
</ul>
<h4 id="931-multiple-comparisons">9.3.1. Multiple comparisons</h4>
<ul>
<li>
<p>Figure 9.2. Plot of Tukey HSD <strong>pairwise mean</strong> comparisons.</p>
<p><img src="fig92.png" alt="fig92"></p>
</li>
<li>
<p>Figure 9.3. Tukey HSD tests provided by the multcomp package.</p>
<p><img src="fig93.png" alt="fig93"></p>
</li>
<li>
<p>Figure 9.4. Test of normality.</p>
<p><img src="fig94.png" alt="fig94"></p>
</li>
</ul>
<h3 id="94-one-way-ancova">9.4. One-way ANCOVA</h3>
<h4 id="941-assessing-test-assumptions">9.4.1. Assessing test assumptions</h4>
<ul>
<li>Assume homogeneity of regression slopes</li>
</ul>
<h4 id="942-visualizing-the-results">9.4.2. Visualizing the results</h4>
<ul>
<li>
<p>Figure 9.5. Plot of the relationship between gestation time and birth weight for each of four drug treatment groups.</p>
<p><img src="fig95.png" alt="fig95"></p>
</li>
</ul>
<h3 id="95-two-way-factorial-anova">9.5. Two-way factorial ANOVA</h3>
<ul>
<li>
<p>Figure 9.6. Interaction between dose and delivery mechanism on tooth growth. The plot of means was created using the <code>interaction.plot()</code> function.</p>
<p><img src="fig96.png" alt="fig96"></p>
</li>
<li>
<p>Figure 9.7. Interaction between dose and delivery mechanism on tooth growth. The mean plot with 95 percent confidence intervals was created by the <code>plotmeans()</code> function.</p>
<p><img src="fig97.png" alt="fig97"></p>
</li>
<li>
<p>Figure 9.8. Main effects and two-way interaction for the ToothGrowth dataset. This plot was created by the <code>interaction2way()</code> function in the &ldquo;HH&rdquo; package.</p>
<p><img src="fig98.png" alt="fig98"></p>
</li>
</ul>
<h3 id="96-repeated-measures-anova">9.6. Repeated measures ANOVA</h3>
<ul>
<li>
<p>Figure 9.9. Interaction of ambient CO2 concentration and plant type on CO2 uptake. Graph produced by the <code>interaction.plot()</code> function.</p>
<p><img src="fig99.png" alt="fig99"></p>
</li>
<li>
<p>Figure 9.10. Interaction of ambient CO2 concentration and plant type on CO2 uptake. Graph produced by the <code>boxplot()</code> function.</p>
<p><img src="fig910.png" alt="fig910"></p>
</li>
</ul>
<h3 id="97-multivariate-analysis-of-variance-manova">9.7. Multivariate analysis of variance (MANOVA)</h3>
<h4 id="971-assessing-test-assumptions">9.7.1. Assessing test assumptions</h4>
<ul>
<li>
<p>Figure 9.11. A Q-Q plot for assessing multivariate normality.</p>
<p><img src="fig911.png" alt="fig911"></p>
</li>
<li>
<p><code>aq.plot()</code> in the <strong>mvoutlier</strong> package to check <code>multivariate outliers</code></p>
<p><img src="outliers.png" alt="outliers"></p>
</li>
</ul>
<h4 id="972-robust-manova">9.7.2. Robust MANOVA</h4>
<ul>
<li>
<p>one-way MANOVA</p>
<ul>
<li>with <code>Wilks.test()</code> in the <code>rrcov</code> package.</li>
</ul>
</li>
<li>
<p>a nonparametric MANOVA</p>
<ul>
<li>with <code>adonis()</code> in the <code>vegan</code> package</li>
</ul>
</li>
</ul>
<h3 id="98-anova-as-regression">9.8. ANOVA as regression</h3>
<ul>
<li>
<p>Table 9.6. Built-in contrasts</p>
<p><img src="tab96.png" alt="Tab96"></p>
</li>
</ul>
<p>Attach is the <a href="chapter9.R">Script</a> of chapter9.</p>
<p>Show me the code <i class="far fa-hand-pointer"></i></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span><span class="lnt">399
</span><span class="lnt">400
</span><span class="lnt">401
</span><span class="lnt">402
</span><span class="lnt">403
</span><span class="lnt">404
</span><span class="lnt">405
</span><span class="lnt">406
</span><span class="lnt">407
</span><span class="lnt">408
</span><span class="lnt">409
</span><span class="lnt">410
</span><span class="lnt">411
</span><span class="lnt">412
</span><span class="lnt">413
</span><span class="lnt">414
</span><span class="lnt">415
</span><span class="lnt">416
</span><span class="lnt">417
</span><span class="lnt">418
</span><span class="lnt">419
</span><span class="lnt">420
</span><span class="lnt">421
</span><span class="lnt">422
</span><span class="lnt">423
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Remove most objects from the working environment</span>
<span class="nf">rm</span><span class="p">(</span><span class="n">list</span> <span class="o">=</span> <span class="nf">ls</span><span class="p">())</span>
<span class="nf">options</span><span class="p">(</span><span class="n">stringsAsFactors</span> <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>

<span class="c1"># 9.3. One-way ANOVA</span>
<span class="c1"># code listing 9.1</span>
<span class="nf">library</span><span class="p">(</span><span class="n">multcomp</span><span class="p">)</span>
<span class="nf">attach</span><span class="p">(</span><span class="n">cholesterol</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">cholesterol</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">trt</span><span class="p">)</span>  <span class="c1"># group sample sizes</span>
<span class="c1"># trt</span>
<span class="c1">#  1time 2times 4times  drugD  drugE </span>
<span class="c1">#     10     10     10     10     10 </span>

<span class="nf">aggregate</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">trt</span><span class="p">),</span> <span class="n">mean</span><span class="p">)</span> <span class="c1"># group means</span>
<span class="c1">#   Group.1        x</span>
<span class="c1"># 1   1time  5.78197</span>
<span class="c1"># 2  2times  9.22497</span>
<span class="c1"># 3  4times 12.37478</span>
<span class="c1"># 4   drugD 15.36117</span>
<span class="c1"># 5   drugE 20.94752</span>

<span class="nf">aggregate</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">trt</span><span class="p">),</span> <span class="n">sd</span><span class="p">)</span> <span class="c1"># group standard deviations</span>
<span class="c1">#   Group.1        x</span>
<span class="c1"># 1   1time 2.878113</span>
<span class="c1"># 2  2times 3.483054</span>
<span class="c1"># 3  4times 2.923119</span>
<span class="c1"># 4   drugD 3.454636</span>
<span class="c1"># 5   drugE 3.345003</span>

<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">response</span> <span class="o">~</span> <span class="n">trt</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>  <span class="c1"># Test for group differences(ANOVA)</span>

<span class="c1">#             Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span>
<span class="c1"># trt          4 1351.4   337.8   32.43 9.82e-13 ***</span>
<span class="c1"># Residuals   45  468.8    10.4                     </span>
<span class="c1"># ---</span>
<span class="c1"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>

<span class="nf">library</span><span class="p">(</span><span class="n">gplots</span><span class="p">)</span>
<span class="nf">plotmeans</span><span class="p">(</span><span class="n">response</span> <span class="o">~</span> <span class="n">trt</span><span class="p">,</span>
          <span class="n">xlab</span> <span class="o">=</span> <span class="s">&#34;Treatment&#34;</span><span class="p">,</span>
          <span class="n">ylab</span> <span class="o">=</span> <span class="s">&#34;Response&#34;</span><span class="p">,</span>
          <span class="n">main</span> <span class="o">=</span> <span class="s">&#34;Mean Plot \nwith 95% CI&#34;</span><span class="p">)</span> <span class="c1"># figure 9.1</span>
<span class="nf">detach</span><span class="p">(</span><span class="n">cholesterol</span><span class="p">)</span>

<span class="c1"># 9.3.1. Multiple comparisons</span>
<span class="c1"># code listing 9.2. Tukey HSD pairwise group comparisons</span>
<span class="nf">TukeyHSD</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="c1"># Tukey multiple comparisons of means</span>
<span class="c1">#   95% family-wise confidence level</span>
<span class="c1"># </span>
<span class="c1"># Fit: aov(formula = response ~ trt)</span>
<span class="c1"># </span>
<span class="c1"># $trt</span>
<span class="c1">#                   diff        lwr       upr     p adj</span>
<span class="c1"># 2times-1time   3.44300 -0.6582817  7.544282 0.1380949</span>
<span class="c1"># 4times-1time   6.59281  2.4915283 10.694092 0.0003542</span>
<span class="c1"># drugD-1time    9.57920  5.4779183 13.680482 0.0000003</span>
<span class="c1"># drugE-1time   15.16555 11.0642683 19.266832 0.0000000</span>
<span class="c1"># 4times-2times  3.14981 -0.9514717  7.251092 0.2050382</span>
<span class="c1"># drugD-2times   6.13620  2.0349183 10.237482 0.0009611</span>
<span class="c1"># drugE-2times  11.72255  7.6212683 15.823832 0.0000000</span>
<span class="c1"># drugD-4times   2.98639 -1.1148917  7.087672 0.2512446</span>
<span class="c1"># drugE-4times   8.57274  4.4714583 12.674022 0.0000037</span>
<span class="c1"># drugE-drugD    5.58635  1.4850683  9.687632 0.0030633</span>


<span class="nf">par</span><span class="p">(</span><span class="n">las</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">8</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">TukeyHSD</span><span class="p">(</span><span class="n">fit</span><span class="p">))</span> <span class="c1"># figure 9.2</span>


<span class="nf">library</span><span class="p">(</span><span class="n">multcomp</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="n">tuk</span> <span class="o">&lt;-</span> <span class="nf">glht</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">linfct</span><span class="o">=</span><span class="nf">mcp</span><span class="p">(</span><span class="n">trt</span><span class="o">=</span><span class="s">&#34;Tukey&#34;</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">cld</span><span class="p">(</span><span class="n">tuk</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="m">.05</span><span class="p">),</span><span class="n">col</span><span class="o">=</span><span class="s">&#34;lightgrey&#34;</span><span class="p">)</span> <span class="c1"># figure 9.3</span>


<span class="c1"># 9.3.2. Assessing test assumptions</span>
<span class="c1"># figure 9.4</span>
<span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>
<span class="nf">qqPlot</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">response</span> <span class="o">~</span> <span class="n">trt</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">cholesterol</span><span class="p">),</span>
         <span class="n">simulate</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="s">&#34;Q-Q Plot&#34;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>


<span class="c1"># code</span>
<span class="nf">bartlett.test</span><span class="p">(</span><span class="n">response</span> <span class="o">~</span> <span class="n">trt</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">cholesterol</span><span class="p">)</span>

<span class="c1">#         Bartlett test of homogeneity of variances</span>
<span class="c1"># </span>
<span class="c1"># data:  response by trt</span>
<span class="c1"># Bartlett&#39;s K-squared = 0.57975, df = 4, p-value = 0.9653</span>


<span class="nf">outlierTest</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="c1"># No Studentized residuals with Bonferroni p &lt; 0.05</span>
<span class="c1"># Largest |rstudent|:</span>
<span class="c1">#   rstudent unadjusted p-value Bonferroni p</span>
<span class="c1"># 19 2.251149           0.029422           NA</span>

<span class="c1">#=============================================================</span>

<span class="c1"># 9.4. One-way ANCOVA</span>
<span class="c1"># code listing 9.3. One-way ANCOVA</span>
<span class="nf">data</span><span class="p">(</span><span class="s">&#34;litter&#34;</span><span class="p">,</span> <span class="n">package</span> <span class="o">=</span> <span class="s">&#34;multcomp&#34;</span><span class="p">)</span>
<span class="nf">attach</span><span class="p">(</span><span class="n">litter</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">dose</span><span class="p">)</span>
<span class="c1"># dose</span>
<span class="c1">#   0   5  50 500 </span>
<span class="c1">#   20  19  18  17 </span>

<span class="nf">aggregate</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">dose</span><span class="p">),</span> <span class="n">mean</span><span class="p">)</span>
<span class="c1">#   Group.1        x</span>
<span class="c1"># 1       0 32.30850</span>
<span class="c1"># 2       5 29.30842</span>
<span class="c1"># 3      50 29.86611</span>
<span class="c1"># 4     500 29.64647</span>

<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">weight</span> <span class="o">~</span> <span class="n">gesttime</span> <span class="o">+</span> <span class="n">dose</span><span class="p">)</span> 
<span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>

<span class="c1">#             Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span>
<span class="c1"># trt          4 1351.4   337.8   32.43 9.82e-13 ***</span>
<span class="c1"># Residuals   45  468.8    10.4                     </span>
<span class="c1"># ---</span>
<span class="c1"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>

<span class="nf">library</span><span class="p">(</span><span class="n">effects</span><span class="p">)</span>
<span class="nf">effect</span><span class="p">(</span><span class="s">&#34;dose&#34;</span><span class="p">,</span> <span class="n">fit</span><span class="p">)</span>

<span class="c1">#  dose effect</span>
<span class="c1"># dose</span>
<span class="c1">#        0        5       50      500 </span>
<span class="c1"># 32.35367 28.87672 30.56614 29.33460 </span>


<span class="c1"># code listing 9.4 Multiple comparisons employing user-supplied contrasts</span>
<span class="nf">library</span><span class="p">(</span><span class="n">multcomp</span><span class="p">)</span>
<span class="n">contrast</span> <span class="o">&lt;-</span> <span class="nf">rbind</span><span class="p">(</span><span class="s">&#34;no drug vs. drug&#34;</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">-1</span><span class="p">,</span> <span class="m">-1</span><span class="p">,</span> <span class="m">-1</span><span class="p">))</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">glht</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">linfct</span><span class="o">=</span><span class="nf">mcp</span><span class="p">(</span><span class="n">dose</span><span class="o">=</span><span class="n">contrast</span><span class="p">)))</span>
<span class="c1"># Simultaneous Tests for General Linear Hypotheses</span>
<span class="c1"># </span>
<span class="c1"># Multiple Comparisons of Means: User-defined Contrasts</span>
<span class="c1"># </span>
<span class="c1"># </span>
<span class="c1"># Fit: aov(formula = weight ~ gesttime + dose)</span>
<span class="c1"># </span>
<span class="c1"># Linear Hypotheses:</span>
<span class="c1">#   Estimate Std. Error t value Pr(&gt;|t|)  </span>
<span class="c1"># no drug vs. drug == 0    8.284      3.209   2.581    0.012 *</span>
<span class="c1">#   ---</span>
<span class="c1">#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="c1"># (Adjusted p values reported -- single-step method)</span>

<span class="nf">help</span><span class="p">(</span><span class="s">&#34;glht&#34;</span><span class="p">)</span>

<span class="c1"># 9.4.1. Assessing test assumptions</span>
<span class="c1"># code listing 9.5. Testing for homogeneity of regression slopes</span>
<span class="nf">library</span><span class="p">(</span><span class="n">multcomp</span><span class="p">)</span>
<span class="n">fit2</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">weight</span> <span class="o">~</span> <span class="n">gesttime</span><span class="o">*</span><span class="n">dose</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">litter</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit2</span><span class="p">)</span>

<span class="c1">#               Df Sum Sq Mean Sq F value  Pr(&gt;F)   </span>
<span class="c1"># gesttime       1  134.3  134.30   8.289 0.00537 **</span>
<span class="c1"># dose           3  137.1   45.71   2.821 0.04556 * </span>
<span class="c1"># gesttime:dose  3   81.9   27.29   1.684 0.17889   </span>
<span class="c1"># Residuals     66 1069.4   16.20                   </span>
<span class="c1"># ---</span>
<span class="c1"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>

<span class="c1">#==================================================================</span>
<span class="c1"># 9.4.2. Visualizing the results</span>
<span class="c1"># install.packages(&#34;HH&#34;)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">HH</span><span class="p">)</span>
<span class="nf">ancova</span><span class="p">(</span><span class="n">weight</span> <span class="o">~</span> <span class="n">gesttime</span> <span class="o">+</span> <span class="n">dose</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">litter</span><span class="p">)</span> <span class="c1"># figure 9.5</span>

<span class="c1"># 9.5. Two-way factorial ANOVA</span>
<span class="c1"># code listing 9.6 Two-way ANOVA</span>
<span class="nf">attach</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">)</span>
<span class="c1">#    len supp dose</span>
<span class="c1"># 1  4.2   VC  0.5</span>
<span class="c1"># 2 11.5   VC  0.5</span>
<span class="c1"># 3  7.3   VC  0.5</span>
<span class="c1"># 4  5.8   VC  0.5</span>
<span class="c1"># 5  6.4   VC  0.5</span>
<span class="c1"># 6 10.0   VC  0.5</span>

<span class="nf">class</span><span class="p">(</span><span class="n">dose</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">)</span>
<span class="c1"># [1] &#34;len&#34;  &#34;supp&#34; &#34;dose&#34;</span>

<span class="nf">table</span><span class="p">(</span><span class="n">supp</span><span class="p">,</span><span class="n">dose</span><span class="p">)</span>
<span class="c1">#     dose</span>
<span class="c1"># supp 0.5  1  2</span>
<span class="c1"># OJ  10 10 10</span>
<span class="c1"># VC  10 10 10</span>

<span class="nf">aggregate</span><span class="p">(</span><span class="n">len</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">supp</span><span class="p">,</span> <span class="n">dose</span><span class="p">),</span> <span class="n">mean</span><span class="p">)</span>
<span class="c1">#   Group.1 Group.2     x</span>
<span class="c1"># 1      OJ     0.5 13.23</span>
<span class="c1"># 2      VC     0.5  7.98</span>
<span class="c1"># 3      OJ     1.0 22.70</span>
<span class="c1"># 4      VC     1.0 16.77</span>
<span class="c1"># 5      OJ     2.0 26.06</span>
<span class="c1"># 6      VC     2.0 26.14</span>

<span class="nf">aggregate</span><span class="p">(</span><span class="n">len</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">supp</span><span class="p">,</span> <span class="n">dose</span><span class="p">),</span> <span class="n">sd</span><span class="p">)</span>
<span class="c1">#   Group.1 Group.2        x</span>
<span class="c1"># 1      OJ     0.5 4.459709</span>
<span class="c1"># 2      VC     0.5 2.746634</span>
<span class="c1"># 3      OJ     1.0 3.910953</span>
<span class="c1"># 4      VC     1.0 2.515309</span>
<span class="c1"># 5      OJ     2.0 2.655058</span>
<span class="c1"># 6      VC     2.0 4.797731</span>

<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">len</span> <span class="o">~</span> <span class="n">supp</span><span class="o">*</span><span class="n">dose</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="c1">#             Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span>
<span class="c1"># supp         1  205.4   205.4  12.317 0.000894 ***</span>
<span class="c1"># dose         1 2224.3  2224.3 133.415  &lt; 2e-16 ***</span>
<span class="c1"># supp:dose    1   88.9    88.9   5.333 0.024631 *  </span>
<span class="c1"># Residuals   56  933.6    16.7                     </span>
<span class="c1"># ---</span>
<span class="c1"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>

<span class="n">dose</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="n">dose</span><span class="p">)</span>
<span class="n">fit2</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">len</span> <span class="o">~</span> <span class="n">supp</span><span class="o">*</span><span class="n">dose</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit2</span><span class="p">)</span>
<span class="c1">#             Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span>
<span class="c1"># supp         1  205.4   205.4  15.572 0.000231 ***</span>
<span class="c1"># dose         2 2426.4  1213.2  92.000  &lt; 2e-16 ***</span>
<span class="c1"># supp:dose    2  108.3    54.2   4.107 0.021860 *  </span>
<span class="c1"># Residuals   54  712.1    13.2                     </span>
<span class="c1"># ---</span>
<span class="c1"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>

<span class="nf">detach</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">)</span>

<span class="c1"># figure 9.6</span>
<span class="nf">interaction.plot</span><span class="p">(</span><span class="n">dose</span><span class="p">,</span> <span class="n">supp</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&#34;b&#34;</span><span class="p">,</span>
                 <span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;red&#34;</span><span class="p">,</span><span class="s">&#34;blue&#34;</span><span class="p">),</span> <span class="n">pch</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">16</span><span class="p">,</span> <span class="m">18</span><span class="p">),</span>
                 <span class="n">main</span> <span class="o">=</span> <span class="s">&#34;Interaction between Dose and Supplement Type&#34;</span><span class="p">)</span>

<span class="c1"># figure 9.7</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gplots</span><span class="p">)</span>
<span class="nf">plotmeans</span><span class="p">(</span><span class="n">len</span> <span class="o">~</span> <span class="nf">interaction</span><span class="p">(</span><span class="n">supp</span><span class="p">,</span> <span class="n">dose</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#34; &#34;</span><span class="p">),</span>
          <span class="n">connect</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">6</span><span class="p">)),</span>
          <span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="s">&#34;darkgreen&#34;</span><span class="p">),</span>
          <span class="n">main</span> <span class="o">=</span> <span class="s">&#34;Interaction Plot with 95% CIs&#34;</span><span class="p">,</span>
          <span class="n">xlab</span><span class="o">=</span><span class="s">&#34;Treatment and Dose Combination&#34;</span><span class="p">)</span>

<span class="c1"># figure 9.8</span>
<span class="nf">library</span><span class="p">(</span><span class="n">HH</span><span class="p">)</span>
<span class="nf">interaction2wt</span><span class="p">(</span><span class="n">len</span><span class="o">~</span><span class="n">supp</span><span class="o">*</span><span class="n">dose</span><span class="p">)</span>

<span class="c1"># 9.6. Repeated measures ANOVA</span>
<span class="c1"># code listing 9.7. Repeated measures ANOVA with one between- and within-groups factor</span>
<span class="n">CO2</span><span class="o">$</span><span class="n">conc</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="n">CO2</span><span class="o">$</span><span class="n">conc</span><span class="p">)</span>
<span class="n">w1b1</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">CO2</span><span class="p">,</span> <span class="n">Treatment</span><span class="o">==</span><span class="s">&#39;chilled&#39;</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">conc</span><span class="o">*</span><span class="n">Type</span> <span class="o">+</span> <span class="nf">Error</span><span class="p">(</span><span class="n">Plant</span><span class="o">/</span><span class="p">(</span><span class="n">conc</span><span class="p">)),</span> <span class="n">w1b1</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="c1"># Error: Plant</span>
<span class="c1">#           Df Sum Sq Mean Sq F value  Pr(&gt;F)   </span>
<span class="c1"># Type       1 2667.2  2667.2   60.41 0.00148 **</span>
<span class="c1"># Residuals  4  176.6    44.1                   </span>
<span class="c1"># ---</span>
<span class="c1"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="c1"># </span>
<span class="c1"># Error: Plant:conc</span>
<span class="c1">#           Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span>
<span class="c1"># conc       6 1472.4  245.40   52.52 1.26e-12 ***</span>
<span class="c1"># conc:Type  6  428.8   71.47   15.30 3.75e-07 ***</span>
<span class="c1"># Residuals 24  112.1    4.67                     </span>
<span class="c1"># ---</span>
<span class="c1"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>

<span class="nf">par</span><span class="p">(</span><span class="n">las</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
<span class="c1"># figure 9.9</span>
<span class="nf">with</span><span class="p">(</span><span class="n">w1b1</span><span class="p">,</span> <span class="nf">interaction.plot</span><span class="p">(</span><span class="n">conc</span><span class="p">,</span><span class="n">Type</span><span class="p">,</span><span class="n">uptake</span><span class="p">,</span>
                            <span class="n">type</span><span class="o">=</span><span class="s">&#34;b&#34;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;red&#34;</span><span class="p">,</span><span class="s">&#34;blue&#34;</span><span class="p">),</span> <span class="n">pch</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">16</span><span class="p">,</span><span class="m">18</span><span class="p">),</span>
                            <span class="n">main</span><span class="o">=</span><span class="s">&#34;Interaction Plot for Plant Type and Concentration&#34;</span><span class="p">))</span>

<span class="c1"># figure 9.10</span>
<span class="nf">boxplot</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Type</span><span class="o">*</span><span class="n">conc</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">w1b1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;gold&#34;</span><span class="p">,</span> <span class="s">&#34;green&#34;</span><span class="p">)),</span>
        <span class="n">main</span><span class="o">=</span><span class="s">&#34;Chilled Quebec and Mississippi Plants&#34;</span><span class="p">,</span>
        <span class="n">ylab</span><span class="o">=</span><span class="s">&#34;Carbon dioxide uptake rate (umol/m^2 sec)&#34;</span><span class="p">)</span>


<span class="c1"># 9.7. Multivariate analysis of variance (MANOVA)</span>
<span class="c1"># code listing 9.8. One-way MANOVA</span>
<span class="nf">library</span><span class="p">(</span><span class="n">MASS</span><span class="p">)</span>
<span class="nf">attach</span><span class="p">(</span><span class="n">UScereal</span><span class="p">)</span>
<span class="n">shelf</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="n">shelf</span><span class="p">)</span>
<span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">cbind</span><span class="p">(</span><span class="n">calories</span><span class="p">,</span> <span class="n">fat</span><span class="p">,</span> <span class="n">sugars</span><span class="p">)</span>
<span class="nf">aggregate</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">shelf</span><span class="p">),</span> <span class="n">mean</span><span class="p">)</span>
<span class="c1">#   Group.1 calories       fat    sugars</span>
<span class="c1"># 1       1 119.4774 0.6621338  6.295493</span>
<span class="c1"># 2       2 129.8162 1.3413488 12.507670</span>
<span class="c1"># 3       3 180.1466 1.9449071 10.856821</span>

<span class="nf">cov</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="c1">#            calories       fat     sugars</span>
<span class="c1"># calories 3895.24210 60.674383 180.380317</span>
<span class="c1"># fat        60.67438  2.713399   3.995474</span>
<span class="c1"># sugars    180.38032  3.995474  34.050018</span>

<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">manova</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">shelf</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>  
<span class="c1">#           Df Pillai approx F num Df den Df    Pr(&gt;F)    </span>
<span class="c1"># shelf      2 0.4021   5.1167      6    122 0.0001015 ***</span>
<span class="c1"># Residuals 62                                            </span>
<span class="c1"># ---</span>
<span class="c1"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
  
  
<span class="nf">summary.aov</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="c1"># Response calories :</span>
<span class="c1">#             Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span>
<span class="c1"># shelf        2  50435 25217.6  7.8623 0.0009054 ***</span>
<span class="c1"># Residuals   62 198860  3207.4                      </span>
<span class="c1"># ---</span>
<span class="c1"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="c1"># </span>
<span class="c1"># Response fat :</span>
<span class="c1">#             Df Sum Sq Mean Sq F value  Pr(&gt;F)  </span>
<span class="c1"># shelf        2  18.44  9.2199  3.6828 0.03081 *</span>
<span class="c1"># Residuals   62 155.22  2.5035                  </span>
<span class="c1"># ---</span>
<span class="c1"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="c1"># </span>
<span class="c1"># Response sugars :</span>
<span class="c1">#             Df  Sum Sq Mean Sq F value   Pr(&gt;F)   </span>
<span class="c1"># shelf        2  381.33 190.667  6.5752 0.002572 **</span>
<span class="c1"># Residuals   62 1797.87  28.998                    </span>
<span class="c1"># ---</span>
<span class="c1"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>


<span class="c1"># 9.7.1. Assessing test assumptions</span>
<span class="c1"># code listing 9.9. Assessing multivariate normality</span>
<span class="n">center</span> <span class="o">&lt;-</span> <span class="nf">colMeans</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">n</span> <span class="o">&lt;-</span> <span class="nf">nrow</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">p</span> <span class="o">&lt;-</span> <span class="nf">ncol</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">cov</span> <span class="o">&lt;-</span> <span class="nf">cov</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">d</span> <span class="o">&lt;-</span> <span class="nf">mahalanobis</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">cov</span><span class="p">)</span>

<span class="c1"># figure 9.11</span>
<span class="n">coord</span> <span class="o">&lt;-</span> <span class="nf">qqplot</span><span class="p">(</span><span class="nf">qchisq</span><span class="p">(</span><span class="nf">ppoints</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">df</span><span class="o">=</span><span class="n">p</span><span class="p">),</span>
                <span class="n">d</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="s">&#34;Q-Q Plot Assessing Multivariate Normality&#34;</span><span class="p">,</span>
                <span class="n">ylab</span><span class="o">=</span><span class="s">&#34;Mahalanobis D2&#34;</span><span class="p">)</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="nf">identify</span><span class="p">(</span><span class="n">coord</span><span class="o">$</span><span class="n">x</span><span class="p">,</span> <span class="n">coord</span><span class="o">$</span><span class="n">y</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nf">row.names</span><span class="p">(</span><span class="n">UScereal</span><span class="p">))</span>

<span class="c1">#================================================================</span>
<span class="c1"># install.packages(&#34;mvoutlier&#34;)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">mvoutlier</span><span class="p">)</span>
<span class="n">outliers</span> <span class="o">&lt;-</span> <span class="nf">aq.plot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">outliers</span>

<span class="c1"># 9.7.2. Robust MANOVA</span>
<span class="c1"># code listing 9.10. Robust one-way MANOVA</span>
<span class="nf">library</span><span class="p">(</span><span class="n">rrcov</span><span class="p">)</span>
<span class="nf">Wilks.test</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">shelf</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&#34;mcd&#34;</span><span class="p">)</span>
<span class="c1">#         Robust One-way MANOVA (Bartlett Chi2)</span>
<span class="c1"># </span>
<span class="c1"># data:  x</span>
<span class="c1"># Wilks&#39; Lambda = 0.51073, Chi2-Value = 25.3745, DF = 5.1632, p-value = 0.0001377</span>
<span class="c1"># sample estimates:</span>
<span class="c1">#   calories       fat    sugars</span>
<span class="c1"># 1 119.8210 0.7010828  5.663143</span>
<span class="c1"># 2 128.0407 1.1849576 12.537533</span>
<span class="c1"># 3 160.8604 1.6524559 10.352646</span>


<span class="c1"># 9.8. ANOVA as regression</span>
<span class="nf">library</span><span class="p">(</span><span class="n">multcomp</span><span class="p">)</span>
<span class="nf">levels</span><span class="p">(</span><span class="n">cholesterol</span><span class="o">$</span><span class="n">trt</span><span class="p">)</span>
<span class="c1"># [1] &#34;1time&#34;  &#34;2times&#34; &#34;4times&#34; &#34;drugD&#34;  &#34;drugE&#34;</span>

<span class="n">fit.aov</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">response</span> <span class="o">~</span> <span class="n">trt</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">cholesterol</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.aov</span><span class="p">)</span>
<span class="c1">#             Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span>
<span class="c1"># trt          4 1351.4   337.8   32.43 9.82e-13 ***</span>
<span class="c1"># Residuals   45  468.8    10.4                     </span>
<span class="c1"># ---</span>
<span class="c1"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>


<span class="c1"># code listing 9.11. A regression approach to the ANOVA problem in section 9.3</span>
<span class="n">fit.lm</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">response</span> <span class="o">~</span> <span class="n">trt</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">cholesterol</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit.lm</span><span class="p">)</span>

<span class="c1"># Call:</span>
<span class="c1">#   lm(formula = response ~ trt, data = cholesterol)</span>
<span class="c1"># </span>
<span class="c1"># Residuals:</span>
<span class="c1">#   Min      1Q  Median      3Q     Max </span>
<span class="c1"># -6.5418 -1.9672 -0.0016  1.8901  6.6008 </span>
<span class="c1"># </span>
<span class="c1"># Coefficients:</span>
<span class="c1">#             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="c1"># (Intercept)    5.782      1.021   5.665 9.78e-07 ***</span>
<span class="c1">#   trt2times      3.443      1.443   2.385   0.0213 *  </span>
<span class="c1">#   trt4times      6.593      1.443   4.568 3.82e-05 ***</span>
<span class="c1">#   trtdrugD       9.579      1.443   6.637 3.53e-08 ***</span>
<span class="c1">#   trtdrugE      15.166      1.443  10.507 1.08e-13 ***</span>
<span class="c1">#   ---</span>
<span class="c1"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="c1"># </span>
<span class="c1"># Residual standard error: 3.227 on 45 degrees of freedom</span>
<span class="c1"># Multiple R-squared:  0.7425, Adjusted R-squared:  0.7196 </span>
<span class="c1"># F-statistic: 32.43 on 4 and 45 DF,  p-value: 9.819e-13</span>

<span class="nf">contrasts</span><span class="p">(</span><span class="n">cholesterol</span><span class="o">$</span><span class="n">trt</span><span class="p">)</span>
<span class="c1">#        2times 4times drugD drugE</span>
<span class="c1"># 1time       0      0     0     0</span>
<span class="c1"># 2times      1      0     0     0</span>
<span class="c1"># 4times      0      1     0     0</span>
<span class="c1"># drugD       0      0     1     0</span>
<span class="c1"># drugE       0      0     0     1</span>
</code></pre></td></tr></table>
</div>
</div>
    </div>

    
    


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://xiaonilee.github.io/tags/r/">R</a>
          <a href="https://xiaonilee.github.io/tags/r-in-action/">R in Action</a>
          <a href="https://xiaonilee.github.io/tags/bioinformatics/">Bioinformatics</a>
          <a href="https://xiaonilee.github.io/tags/book/">Book</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/rinaction10/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">Chapter 10. Power analysis</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="/post/rinaction8/">
            <span class="next-text nav-default">Chapter 8. Regression</span>
            <span class="prev-text nav-mobile">Next</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:xiaoni0601@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/xiaonilee" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="https://xiaonilee.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">

  <span class="copyright-year">
    &copy;
    2020
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        xiaonilee
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>



  <script type="text/javascript">
    window.MathJax = {
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script>









  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  















</body>
</html>
