<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>TensorFlow2 class5: 卷积神经网络 - xiaoni&#39;s blog</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="Xiaoni" />
  <meta name="description" content="TensorFlow2 notebook: Class5: 卷积神经网络.
" />

  <meta name="keywords" content="xiaonili, xiaonilee, xiaoni" />






<meta name="generator" content="Hugo 0.79.0" />


<link rel="canonical" href="https://xiaonilee.github.io/post/tensorflow205/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.f1e506a781bf25d33ffc18aa6b4e972a965c58049d27d4f92b7db2e9bf28e4bf.css" integrity="sha256-8eUGp4G/JdM//Biqa06XKpZcWASdJ9T5K32y6b8o5L8=" media="screen" crossorigin="anonymous">



<link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/css/all.css" rel="stylesheet">
<script src="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/js/all.js"></script>




<meta property="og:title" content="TensorFlow2 class5: 卷积神经网络" />
<meta property="og:description" content="TensorFlow2 notebook: Class5: 卷积神经网络." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xiaonilee.github.io/post/tensorflow205/" />
<meta property="article:published_time" content="2020-12-10T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-12-13T00:00:00+00:00" />
<meta itemprop="name" content="TensorFlow2 class5: 卷积神经网络">
<meta itemprop="description" content="TensorFlow2 notebook: Class5: 卷积神经网络.">
<meta itemprop="datePublished" content="2020-12-10T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-12-13T00:00:00+00:00" />
<meta itemprop="wordCount" content="2379">



<meta itemprop="keywords" content="TensorFlow2,ML," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="TensorFlow2 class5: 卷积神经网络"/>
<meta name="twitter:description" content="TensorFlow2 notebook: Class5: 卷积神经网络."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-177860608-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Xiaoni's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/">Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/post/">Archives</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/categories/">Categories</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/tags/">Tags</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/about/">About Me</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          <div class="mobile-menu-parent">
            <span class="mobile-submenu-open"></span>
            <a href="https://xiaonilee.github.io/">
              docs
            </a>
          </div>
          <ul class="mobile-submenu-list">
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow2/"> ML Notebook: TensorFlow2</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/rinactionmap/">Book: R in Action</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/firebrowse/">FireBrowse Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gdc/">GDC Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gscalite/">GSCALite: Gene Set Cancer Analysis</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/localxenadatahub/">Local UCSC Xena Data Hub</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/oncolnc/">OncoLnc: A straightforward Tool</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/hmwk10/">R Notebook : Application Exercises</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/ggplot2/">R Notebook : ggplot2</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tricktcga/">R re-analysis in TCGA</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow205/">TensorFlow2 class5: 卷积神经网络</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow206/">TensorFlow2 class6: 循环神经网络</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tissgdb/">TissGDB: tissue-specific gene database in cancer</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/genomicsignatures/">UCSC Xena Features: Genomic Signatures</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/loaddata/">UCSC Xena: Load Data From Public Database</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/privatepublictogether/">UCSC Xena: Private and Public Data Put Together</a>
              </li>
            
          </ul>
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Xiaoni's Blog
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/">Home</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/post/">Archives</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/categories/">Categories</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/tags/">Tags</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/about/">About Me</a>
          

        

      </li>
    
        <li class="menu-item active">
        
          
          <a class="menu-item-link menu-parent" href="https://xiaonilee.github.io/">docs</a>
          <ul class="submenu" >
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow2/"> ML Notebook: TensorFlow2</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/rinactionmap/">Book: R in Action</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/firebrowse/">FireBrowse Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gdc/">GDC Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gscalite/">GSCALite: Gene Set Cancer Analysis</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/localxenadatahub/">Local UCSC Xena Data Hub</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/oncolnc/">OncoLnc: A straightforward Tool</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/hmwk10/">R Notebook : Application Exercises</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/ggplot2/">R Notebook : ggplot2</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tricktcga/">R re-analysis in TCGA</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow205/">TensorFlow2 class5: 卷积神经网络</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow206/">TensorFlow2 class6: 循环神经网络</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tissgdb/">TissGDB: tissue-specific gene database in cancer</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/genomicsignatures/">UCSC Xena Features: Genomic Signatures</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/loaddata/">UCSC Xena: Load Data From Public Database</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/privatepublictogether/">UCSC Xena: Private and Public Data Put Together</a>
              </li>
            
          </ul>

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">TensorFlow2 class5: 卷积神经网络</h1>
      
      <div class="post-meta">
        <time datetime="2020-12-10" class="post-time">
          2020-12-10
        </time>
        <div class="post-category">
            <a href="https://xiaonilee.github.io/categories/tensorflow2/"> TensorFlow2 </a>
            <a href="https://xiaonilee.github.io/categories/ml/"> ML </a>
            <a href="https://xiaonilee.github.io/categories/big-data/"> big data </a>
            
          </div>
        

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Table of Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#in-summary">In summary</a>
      <ul>
        <li><a href="#50-回顾">5.0 回顾</a></li>
        <li><a href="#51-卷积计算过程">5.1 卷积计算过程</a></li>
        <li><a href="#52-感受野receptive-field">5.2 感受野Receptive Field</a></li>
        <li><a href="#53-全零填充padding">5.3 全零填充padding</a></li>
        <li><a href="#54-tf描述卷积计算层函数">5.4 TF描述卷积计算层函数</a></li>
        <li><a href="#55-批标准化batch-normalization-bn">5.5 批标准化(Batch Normalization, BN)</a></li>
        <li><a href="#56-池化pooling">5.6 池化Pooling</a></li>
        <li><a href="#57-舍弃dropout">5.7 舍弃Dropout</a></li>
        <li><a href="#58-卷积神经网络">5.8 卷积神经网络</a></li>
        <li><a href="#59-cifar10数据集">5.9 Cifar10数据集</a></li>
        <li><a href="#510-卷积神经网络搭建示例">5.10 卷积神经网络搭建示例</a></li>
        <li><a href="#511-lenet">5.11 LeNet</a></li>
        <li><a href="#512-alexnet">5.12 AlexNet</a></li>
        <li><a href="#513-vggnet">5.13 VGGNet</a></li>
        <li><a href="#514-inceptionnet">5.14 InceptionNet</a></li>
        <li><a href="#515-resnet">5.15 ResNet</a></li>
        <li><a href="#516-经典卷积网络小结">5.16 经典卷积网络小结</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <p>TensorFlow2 notebook: Class5: 卷积神经网络.</p>
<h2 id="in-summary">In summary</h2>
<h3 id="50-回顾">5.0 回顾</h3>
<ul>
<li><strong>全连接NN</strong>:
<ul>
<li>每个神经元与前后相邻层的每一个神经元都有连接关系, 输入是特征, 输出为预测的结果.</li>
<li>参数个数:
<ul>
<li>∑各层(前层神经元 x 后层神经元 + 后层神经元)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="51-卷积计算过程">5.1 卷积计算过程</h3>
<ul>
<li>卷积Convolutional
<ul>
<li>一种有效提取图像特征的方法</li>
<li>一个正方形的卷积核</li>
<li>指定步长滑动</li>
<li>每一个步长, 卷积核会与输入特征图出现重合区域, 重合区域对应元素相乘与求和,最后加上偏置项, 得到输出特征的一个像素点</li>
<li>遍历输入特征图中的每个像素点</li>
<li>输入特征图的深度(channel数), 决定了当前层卷积核的深度</li>
<li>当前层卷积核的个数，决定了当前层输出特征图的深度</li>
</ul>
</li>
</ul>
<h3 id="52-感受野receptive-field">5.2 感受野Receptive Field</h3>
<ul>
<li>卷积神经网络各输出特征图中的每个像素点，在原始输入图片上映射区域的大小</li>
</ul>
<h3 id="53-全零填充padding">5.3 全零填充padding</h3>
<ul>
<li>TF描述全零填充
<ul>
<li>全零填充时, 参数为<code>padding = ‘SAME’</code>, 此时的输出特征图片边长=输入特征图片边长/步长</li>
<li>不全零填充时, 参数设置为<code>padding = ‘VALID’</code>, 此时的输出特征图片边长=输入特征图片边长-卷积核核长+1/步长</li>
<li>输出特征图边长向上取整</li>
</ul>
</li>
</ul>
<h3 id="54-tf描述卷积计算层函数">5.4 TF描述卷积计算层函数</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">Ttf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
<span class="n">filters</span> <span class="o">=</span> <span class="err">卷积核个数</span><span class="p">,</span>
<span class="n">kernel_size</span> <span class="o">=</span> <span class="err">卷积核尺寸</span><span class="p">,</span> <span class="c1">#正方形写核长整数，或(核高h，核宽w)</span>
<span class="n">strides</span> <span class="o">=</span> <span class="err">滑动步长</span><span class="p">,</span> <span class="c1">#横纵向相同写步长整数，或(纵向步长h，横向步长w)，默认1 </span>
<span class="n">padding</span> <span class="o">=</span> <span class="err">“</span><span class="n">same</span><span class="err">”</span> <span class="ow">or</span> <span class="err">“</span><span class="n">valid</span><span class="err">”</span><span class="p">,</span> <span class="c1">#使用全零填充是“same”，不使用是“valid”(默认) activation = “ relu ” or “ sigmoid ” or “ tanh ” or “ softmax”等 , #如有BN此处不写 </span>
<span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="err">高</span><span class="p">,</span> <span class="err">宽</span> <span class="p">,</span> <span class="err">通道数</span><span class="p">)</span> <span class="c1">#输入特征图维度，可省略</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="55-批标准化batch-normalization-bn">5.5 批标准化(Batch Normalization, BN)</h3>
<ul>
<li>标准化
<ul>
<li>使数据符合0均值，1为标准差的分布。</li>
</ul>
</li>
<li>批标准化
<ul>
<li>对一小批数据(batch)，做标准化处理。</li>
</ul>
</li>
<li>为每个卷积核<strong>引入可训练参数𝜸和𝜷</strong>，调整<strong>批归一化</strong>的力度。</li>
<li>BN层位于<em><strong>卷积层之后，激活层之前</strong></em></li>
<li>TF描述批标准化函数</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python">  <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="56-池化pooling">5.6 池化Pooling</h3>
<ul>
<li>用于减少特征数据量</li>
<li><strong>最大值池化</strong>可提取图片纹理</li>
<li><strong>均值池化</strong>可保留背景特征</li>
<li>TF描述最大化池化函数</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">(</span> 
<span class="n">pool_size</span><span class="o">=</span><span class="err">池化核尺寸，</span><span class="c1">#正方形写核长整数，或(核高h，核宽w) </span>
<span class="n">strides</span><span class="o">=</span><span class="err">池化步长，</span><span class="c1">#步长整数， 或(纵向步长h，横向步长w)，默认为pool_size </span>
<span class="n">padding</span><span class="o">=</span><span class="err">‘</span><span class="n">valid</span><span class="err">’</span><span class="ow">or</span><span class="err">‘</span><span class="n">same</span><span class="err">’</span> <span class="c1">#使用全零填充是“same”，不使用是“valid”(默认) </span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>TF描述均值池化函数</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">AveragePooling2D</span><span class="p">(</span> 
<span class="n">pool_size</span><span class="o">=</span><span class="err">池化核尺寸，</span><span class="c1">#正方形写核长整数，或(核高h，核宽w) </span>
<span class="n">strides</span><span class="o">=</span><span class="err">池化步长，</span><span class="c1">#步长整数， 或(纵向步长h，横向步长w)，默认为pool_size </span>
<span class="n">padding</span><span class="o">=</span><span class="err">‘</span><span class="n">valid</span><span class="err">’</span><span class="ow">or</span><span class="err">‘</span><span class="n">same</span><span class="err">’</span> <span class="c1">#使用全零填充是“same”，不使用是“valid”(默认) </span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="57-舍弃dropout">5.7 舍弃Dropout</h3>
<ul>
<li>在神经网络训练时，将一部分神经元按照<strong>一定概率</strong>从神经网络中<em><strong>暂时</strong></em>舍弃(～休眠)。神经网络使用时，被舍弃的神经元恢复链接</li>
<li>TF描述池化函数</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="err">舍弃的概率</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="58-卷积神经网络">5.8 卷积神经网络</h3>
<ul>
<li>卷积核提取特征</li>
<li>送入全连接网络</li>
<li>卷积神经网络网络的主要模块
<ul>
<li><strong>C</strong>onvolutional卷积</li>
<li><strong>B</strong>N批标准化</li>
<li><strong>A</strong>ctivation激活</li>
<li><strong>P</strong>ooling池化</li>
<li><strong>D</strong>ropout舍弃</li>
</ul>
</li>
<li><strong>卷积是什么?</strong>
<ul>
<li>卷积就是<em><strong>特征提取器</strong></em>，就是<em><strong>CBAPD</strong></em></li>
</ul>
</li>
</ul>
<h3 id="59-cifar10数据集">5.9 Cifar10数据集</h3>
<ul>
<li>
<p>彩色图片</p>
</li>
<li>
<p>由<strong>6万</strong>张(<strong>32x32</strong>) 像素点的彩色图片和<strong>十分类</strong>标签构成, 其中</p>
<ul>
<li><strong>5</strong>万张作为训练集</li>
<li><strong>1</strong>万张作为测试集</li>
</ul>
</li>
<li>
<p>导入数据集</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">cifar10</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">cifar10</span>
<span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">cifar10</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="510-卷积神经网络搭建示例">5.10 卷积神经网络搭建示例</h3>
<ul>
<li>共<strong>3</strong>层神经网络
<ul>
<li><strong>1层卷积</strong>
<ul>
<li>C(核:6<em>5</em>5，步长:1，填充:same )</li>
<li>B(Yes)</li>
<li>A(relu)</li>
<li>P(max，核:2*2，步长:2，填充:same)</li>
<li>D(0.2)</li>
</ul>
</li>
<li><strong>2层全连接</strong>
<ul>
<li>Flatten</li>
<li>Dense(神经元:128，激活:relu，Dropout:0.2)</li>
<li>Dense(神经元:10，激活:softmax)</li>
</ul>
</li>
</ul>
</li>
<li>训练结果保存在<strong>checkpoint</strong>文件夹以及<strong>weights.txt</strong>文件中
<ul>
<li><a href="510/Baseline.ckpt.data-00000-of-00001">Baseline.ckpt.data-00000-of-00001</a></li>
<li><a href="510/Baseline.ckpt.index">Baseline.ckpt.index</a></li>
<li><a href="510/checkpoint">checkpoint</a></li>
<li><a href="510/weights.txt">weights</a></li>
</ul>
</li>
</ul>
<h3 id="511-lenet">5.11 LeNet</h3>
<ul>
<li>Yann LeCun于1998年提出</li>
<li>那年没有BN, 没有Dropout</li>
<li>激活函数只有Sigmoid</li>
<li>卷积网络的开篇之作</li>
<li><strong>共享卷积核</strong>，减少了网络的参数</li>
<li>共<strong>5</strong>层网络
<ul>
<li><strong>2</strong>层卷积计算层</li>
<li><strong>3</strong>层全连接计算层</li>
</ul>
</li>
<li>训练结果保存在<strong>checkpoint</strong>文件夹以及<strong>weights.txt</strong>文件中
<ul>
<li><a href="511/LeNet5.ckpt.data-00000-of-00001">LeNet5.ckpt.data-00000-of-00001</a></li>
<li><a href="511/LeNet5.ckpt.index">LeNet5.ckpt.index</a></li>
<li><a href="511/checkpoint">checkpoint</a></li>
<li><a href="511/weights.txt">weights</a></li>
</ul>
</li>
</ul>
<h3 id="512-alexnet">5.12 AlexNet</h3>
<ul>
<li>诞生于2012年，当年ImageNet竞赛的冠军，Top5错误率为16.4%</li>
<li>用到了<strong>LRN</strong>(local response normalization局部响应标准化, 非现如今的主流BN方法)</li>
<li>relu激活函数</li>
<li>Dropout缓解过拟合</li>
<li>共<strong>8</strong>层网络
<ul>
<li><strong>5</strong>层卷积层</li>
<li><strong>3</strong>层全连接层</li>
</ul>
</li>
</ul>
<h3 id="513-vggnet">5.13 VGGNet</h3>
<ul>
<li>诞生于2014年，当年ImageNet竞赛的亚军，Top5错误率减小到7.3%</li>
<li><strong>小尺寸</strong>卷积核</li>
<li>网络结构规整, 适合硬件加速</li>
<li><strong>16</strong>层网络
<ul>
<li><strong>13</strong>层卷积(<code>CBA</code> <code>CBAPD</code> <code>CBA</code> <code>CBAPD</code> <code>CBA</code> <code>CBA</code> <code>CBAPD</code> <code>CBA</code> <code>CBA</code> <code>CBAPD</code> <code>CBA</code> <code>CBAPD</code> <code>CBAPD</code>)</li>
<li><strong>3</strong>层全连接</li>
</ul>
</li>
</ul>
<h3 id="514-inceptionnet">5.14 InceptionNet</h3>
<ul>
<li>诞生于2014年，当年ImageNet竞赛冠军，Top5错误率为6.67%</li>
<li>Inception结构块为基本单元
<ul>
<li>包含4分支, 分别由
<ul>
<li><code>1*1</code>卷积核输出到卷积连接器;</li>
<li><code>1*1</code>卷积核配合<code>3*3</code>卷积核输出到卷积连接器;</li>
<li><code>1*1</code>卷积核配合<code>5*5</code>卷积核输出到卷积连接器;</li>
<li><code>3*3</code>最大池化核配合<code>1*1</code>卷积核输出到卷积连接器;</li>
</ul>
</li>
<li>卷积连接器将4分支特征数据按照深度方向拼接，作为输出</li>
<li>在同一层网络内使用多个不同尺寸的卷积核, 提取不同尺寸的特征</li>
<li>通过设定<code>1*1</code>卷积核的<strong>个数</strong>,减少了输出特征图的深度,达到降维作用</li>
<li>减少参数量和计算量</li>
</ul>
</li>
<li>使用BN缓解梯度消失</li>
</ul>
<h3 id="515-resnet">5.15 ResNet</h3>
<ul>
<li>诞生于2015年，当年ImageNet竞赛冠军，Top5错误率为3.57%</li>
<li>提出了层间残差跳连, 引入了前方信息,防止前边特征丢失, 使得可以增加神经网络层数</li>
<li>跳连线
<ul>
<li>将前边特征直接接到后边</li>
<li>使得神经网络可以更深发展</li>
<li>两路特征图对应元素值相加
<ul>
<li>虚线表示不同维度:<code>H(x)=F(x)+W(x)</code>, W是<code>1*1</code>卷积操作，调整x的维度</li>
<li>实线表示相同维度:<code>H(x)=F(x)+x</code>, 做矩阵相加</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="516-经典卷积网络小结">5.16 经典卷积网络小结</h3>
<p><img src="fig1.png" alt="fig1.png"></p>
<p>Attach is the file of <a href="TensorFlow2class5.ipynb">TensorFlow2class5.ipynb</a>, or view it via the <a href="https://colab.research.google.com/drive/1VJRSP3UZltEarQJLlTreAe-Kjit6i29n?usp=sharing">link</a>.</p>
<p>Show me the code <i class="far fa-hand-point-down"></i></p>
<p><a href="https://gist.github.com/xiaonilee/1d71e54127ec28a7c40bba228963aa21"><img src="fig2.png" alt="fig2"></a>
<a href="https://gist.github.com/xiaonilee/1d71e54127ec28a7c40bba228963aa21"><img src="fig3.png" alt="fig3"></a></p>
<script type="text/javascript" src="http://gist.github.com/1d71e54127ec28a7c40bba228963aa21.js"></script>
    </div>

    
    


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://xiaonilee.github.io/tags/tensorflow2/">TensorFlow2</a>
          <a href="https://xiaonilee.github.io/tags/ml/">ML</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/tensorflow206/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">TensorFlow2 class6: 循环神经网络</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="/post/tensorflow204/">
            <span class="next-text nav-default">TensorFlow2 class4: 网络八股扩展</span>
            <span class="prev-text nav-mobile">Next</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:xiaoni0601@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/xiaonilee" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="https://xiaonilee.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">

  <span class="copyright-year">
    &copy;
    2020
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        xiaonilee
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>



  <script type="text/javascript">
    window.MathJax = {
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script>









  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  















</body>
</html>
