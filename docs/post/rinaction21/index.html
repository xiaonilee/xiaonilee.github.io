<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 21. Creating a package - xiaoni&#39;s blog</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="Xiaoni" />
  <meta name="description" content="Notebook of Reading Books: R in Action_Chapter 21.
" />

  <meta name="keywords" content="xiaonili, xiaonilee, xiaoni" />






<meta name="generator" content="Hugo 0.79.0" />


<link rel="canonical" href="https://xiaonilee.github.io/post/rinaction21/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.f1e506a781bf25d33ffc18aa6b4e972a965c58049d27d4f92b7db2e9bf28e4bf.css" integrity="sha256-8eUGp4G/JdM//Biqa06XKpZcWASdJ9T5K32y6b8o5L8=" media="screen" crossorigin="anonymous">



<link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/css/all.css" rel="stylesheet">
<script src="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/js/all.js"></script>




<meta property="og:title" content="Chapter 21. Creating a package" />
<meta property="og:description" content="Notebook of Reading Books: R in Action_Chapter 21." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xiaonilee.github.io/post/rinaction21/" />
<meta property="article:published_time" content="2020-11-20T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-11-20T00:00:00+00:00" />
<meta itemprop="name" content="Chapter 21. Creating a package">
<meta itemprop="description" content="Notebook of Reading Books: R in Action_Chapter 21.">
<meta itemprop="datePublished" content="2020-11-20T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-11-20T00:00:00+00:00" />
<meta itemprop="wordCount" content="2240">



<meta itemprop="keywords" content="R,R in Action,Bioinformatics,Book," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Chapter 21. Creating a package"/>
<meta name="twitter:description" content="Notebook of Reading Books: R in Action_Chapter 21."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-177860608-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Xiaoni's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/">Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/post/">Archives</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/categories/">Categories</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/tags/">Tags</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/about/">About Me</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          <div class="mobile-menu-parent">
            <span class="mobile-submenu-open"></span>
            <a href="https://xiaonilee.github.io/">
              docs
            </a>
          </div>
          <ul class="mobile-submenu-list">
            
              <li>
                <a href="https://xiaonilee.github.io/post/rinactionmap/">Book: R in Action</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/firebrowse/">FireBrowse Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gdc/">GDC Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gscalite/">GSCALite: Gene Set Cancer Analysis</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/localxenadatahub/">Local UCSC Xena Data Hub</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/oncolnc/">OncoLnc: A straightforward Tool</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/hmwk10/">R Notebook : Application Exercises</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/ggplot2/">R Notebook : ggplot2</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tricktcga/">R re-analysis in TCGA</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow201/">TensorFlow2 class1: Iris</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow202/">TensorFlow2 class2: 数据网络优化</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow203/">TensorFlow2 class3: 神经网络八股</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow204/">TensorFlow2 class4: 网络八股扩展</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow205/">TensorFlow2 class5: 卷积神经网络</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow206/">TensorFlow2 class6: 循环神经网络</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tissgdb/">TissGDB: tissue-specific gene database in cancer</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/genomicsignatures/">UCSC Xena Features: Genomic Signatures</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/loaddata/">UCSC Xena: Load Data From Public Database</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/privatepublictogether/">UCSC Xena: Private and Public Data Put Together</a>
              </li>
            
          </ul>
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Xiaoni's Blog
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/">Home</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/post/">Archives</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/categories/">Categories</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/tags/">Tags</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://xiaonilee.github.io/about/">About Me</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          <a class="menu-item-link menu-parent" href="https://xiaonilee.github.io/">docs</a>
          <ul class="submenu" >
            
              <li>
                <a href="https://xiaonilee.github.io/post/rinactionmap/">Book: R in Action</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/firebrowse/">FireBrowse Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gdc/">GDC Notebook</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/gscalite/">GSCALite: Gene Set Cancer Analysis</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/localxenadatahub/">Local UCSC Xena Data Hub</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/oncolnc/">OncoLnc: A straightforward Tool</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/hmwk10/">R Notebook : Application Exercises</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/ggplot2/">R Notebook : ggplot2</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tricktcga/">R re-analysis in TCGA</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow201/">TensorFlow2 class1: Iris</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow202/">TensorFlow2 class2: 数据网络优化</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow203/">TensorFlow2 class3: 神经网络八股</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow204/">TensorFlow2 class4: 网络八股扩展</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow205/">TensorFlow2 class5: 卷积神经网络</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tensorflow206/">TensorFlow2 class6: 循环神经网络</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/tissgdb/">TissGDB: tissue-specific gene database in cancer</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/genomicsignatures/">UCSC Xena Features: Genomic Signatures</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/loaddata/">UCSC Xena: Load Data From Public Database</a>
              </li>
            
              <li>
                <a href="https://xiaonilee.github.io/post/privatepublictogether/">UCSC Xena: Private and Public Data Put Together</a>
              </li>
            
          </ul>

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Chapter 21. Creating a package</h1>
      
      <div class="post-meta">
        <time datetime="2020-11-20" class="post-time">
          2020-11-20
        </time>
        <div class="post-category">
            <a href="https://xiaonilee.github.io/categories/r/"> R </a>
            <a href="https://xiaonilee.github.io/categories/bioinformatics/"> Bioinformatics </a>
            
          </div>
        

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Table of Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#this-chapter-covers">This chapter covers</a>
      <ul>
        <li><a href="#211-nonparametric-analysis-and-the-npar-package">21.1. Nonparametric analysis and the npar package</a></li>
        <li><a href="#212-developing-the-package">21.2. Developing the package</a></li>
        <li><a href="#213-creating-the-package-documentation">21.3. Creating the package documentation</a></li>
        <li><a href="#214-building-the-package">21.4. Building the package</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <p>Notebook of Reading Books: R in Action_Chapter 21.</p>
<h2 id="this-chapter-covers">This chapter covers</h2>
<ul>
<li>
<p>Creating the functions for a package</p>
</li>
<li>
<p>Adding package documentation</p>
</li>
<li>
<p>Building the package and sharing it with others</p>
</li>
</ul>
<h3 id="211-nonparametric-analysis-and-the-npar-package">21.1. Nonparametric analysis and the npar package</h3>
<ul>
<li>
<p>Figure 21.1. Distribution of healthy life expectancies at age 65 for women in the United States (2007–2009).</p>
<ul>
<li>The scores are <strong>negatively skewed</strong> (fewer scores at the low end).</li>
</ul>
<p><img src="fig211.png" alt="fig211"></p>
</li>
<li>
<p>Figure 21.2. Dot chart of healthy life expectancies by region.</p>
<ul>
<li>The variability of HLE estimates differs across the four regions (compare the Northeast with the South).</li>
</ul>
<p><img src="fig212.png" alt="fig212"></p>
</li>
</ul>
<h4 id="2111-comparing-groups-with-the-npar-package">21.1.1. Comparing groups with the npar package</h4>
<ul>
<li>
<p><strong>oneway {npar}</strong></p>
</li>
<li>
<p>Figure 21.3. Annotated box plots displaying group differences.</p>
<ul>
<li>The plot is annotated with the medians and sample sizes for each group.</li>
<li>The dotted vertical line represents the overall median.</li>
</ul>
<p><img src="fig213.png" alt="fig213"></p>
</li>
</ul>
<h3 id="212-developing-the-package">21.2. Developing the package</h3>
<h4 id="2121-computing-the-statistics">21.2.1. Computing the statistics</h4>
<h4 id="2122-printing-the-results">21.2.2. Printing the results</h4>
<h4 id="2123-summarizing-the-results">21.2.3. Summarizing the results</h4>
<h4 id="2124-plotting-the-results">21.2.4. Plotting the results</h4>
<h4 id="2125-adding-sample-data-to-the-package">21.2.5. Adding sample data to the package</h4>
<h3 id="213-creating-the-package-documentation">21.3. Creating the package documentation</h3>
<ul>
<li>
<p>Table 21.2. Tags for use with Roxygen2</p>
<p><img src="tab1.png" alt="tab1"></p>
</li>
</ul>
<h3 id="214-building-the-package">21.4. Building the package</h3>
<ul>
<li>
<ol>
<li>Install the necessary tools.</li>
</ol>
</li>
<li>
<ol start="2">
<li>Set up the directories.</li>
</ol>
<ul>
<li>
<p><a href="oneway.R">oneway.R</a>, <a href="print.R">print.R</a>, <a href="summary.R">summary.R</a>, <a href="plot.R">plot.R</a>, <a href="npar.R">npar.R</a>, and <a href="life.R">life.R</a> are in the R file.
<img src="rfil.png" alt="rfile"></p>
</li>
<li>
<p><a href="life.rda">life.rda</a> is in the data file.
<img src="dat.png" alt="dat"></p>
</li>
</ul>
</li>
<li>
<ol start="3">
<li>Generate the documentation.</li>
</ol>
</li>
<li>
<p>Be careful with the <em><strong>formal</strong></em> of DESCRIPTION file.</p>
<p><img src="DEP.png" alt="DEP"></p>
<p><img src="genrt.png" alt="genrt"></p>
<p><img src="tree1.png" alt="tree1"></p>
<p><img src="tree2.png" alt="tree2"></p>
</li>
<li>
<ol start="4">
<li>Bulid the package.</li>
</ol>
<p><img src="build1.png" alt="bui1"></p>
</li>
<li>
<ol start="5">
<li>Check the package(optional).</li>
</ol>
<p><img src="check1.png" alt="che">
<img src="check2.png" alt="che"></p>
</li>
<li>
<ol start="6">
<li>Create a <a href="npar.pdf">PDF</a> manual(optional).</li>
</ol>
</li>
<li>
<ol start="7">
<li>Install the package locally (optional).</li>
</ol>
<p><img src="insta.png" alt="inst"></p>
</li>
<li>
<ol start="8">
<li>Upload the package to CRAN(optional).</li>
</ol>
</li>
</ul>
<p>Attach is the <a href="chapter21.R">Script</a> of chapter21.</p>
<p>Show me the code <i class="far fa-hand-pointer"></i></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Remove most objects from the working environment</span>
<span class="nf">rm</span><span class="p">(</span><span class="n">list</span> <span class="o">=</span> <span class="nf">ls</span><span class="p">())</span>
<span class="nf">options</span><span class="p">(</span><span class="n">stringsAsFactors</span> <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>


<span class="n">pkg</span> <span class="o">&lt;-</span> <span class="s">&#34;npar_1.0.tar.gz&#34;</span>
<span class="n">loc</span> <span class="o">&lt;-</span> <span class="s">&#34;http://www.statmethods.net/RiA&#34;</span>
<span class="n">url</span> <span class="o">&lt;-</span> <span class="nf">paste</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">pkg</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#34;/&#34;</span><span class="p">)</span>
<span class="nf">download.file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">pkg</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="n">pkg</span><span class="p">,</span> <span class="n">repos</span><span class="o">=</span><span class="kc">NULL</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&#34;source&#34;</span><span class="p">)</span>


<span class="c1"># 21.1. Nonparametric analysis and the npar package</span>
<span class="nf">library</span><span class="p">(</span><span class="n">npar</span><span class="p">)</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">life</span><span class="o">$</span><span class="n">hlef</span><span class="p">,</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s">&#34;Healthy Life Expectancy (years) at Age 65&#34;</span><span class="p">,</span>
     <span class="n">main</span> <span class="o">=</span> <span class="s">&#34;Distribution of Healthy Life Expectancy for Women&#34;</span><span class="p">,</span>
     <span class="n">col</span> <span class="o">=</span> <span class="s">&#34;grey&#34;</span><span class="p">,</span> <span class="n">breaks</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span> <span class="c1"># figure 21.1</span>

<span class="c1"># figure 21.2</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">life</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">hlef</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;darkgrey&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">labs</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Distribution of HLE Estimates by Region&#34;</span><span class="p">,</span>
       <span class="n">x</span><span class="o">=</span><span class="s">&#34;US Region&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#34;Healthy Life Expectancy at Age 65&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">theme_bw</span><span class="p">()</span>


<span class="c1"># 21.1.1. Comparing groups with the npar package</span>
<span class="c1"># code listing 21.1. Comparison of HLE estimates with the npar package</span>
<span class="nf">library</span><span class="p">(</span><span class="n">npar</span><span class="p">)</span>
<span class="n">results</span> <span class="o">&lt;-</span> <span class="nf">oneway</span><span class="p">(</span><span class="n">hlef</span> <span class="o">~</span> <span class="n">region</span><span class="p">,</span> <span class="n">life</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="c1"># data: hlef on region </span>
<span class="c1"># </span>
<span class="c1"># Omnibus Test</span>
<span class="c1"># Kruskal-Wallis chi-squared = 17.8749, df = 3, p-value = 0.0004668</span>
<span class="c1"># </span>
<span class="c1"># Descriptive Statistics</span>
<span class="c1">#          South North Central    West Northeast</span>
<span class="c1"># n      16.0000      12.00000 13.0000   9.00000</span>
<span class="c1"># median 13.0000      15.40000 15.6000  15.70000</span>
<span class="c1"># mad     1.4826       1.26021  0.7413   0.59304</span>
<span class="c1"># </span>
<span class="c1"># Multiple Comparisons (Wilcoxon Rank Sum Tests)</span>
<span class="c1"># Probability Adjustment = holm</span>
<span class="c1">#         Group.1       Group.2    W           p   </span>
<span class="c1"># 1         South North Central 28.0 0.008583179 **</span>
<span class="c1"># 2         South          West 27.0 0.004737844 **</span>
<span class="c1"># 3         South     Northeast 17.0 0.008583179 **</span>
<span class="c1"># 4 North Central          West 63.5 1.000000000   </span>
<span class="c1"># 5 North Central     Northeast 42.0 1.000000000   </span>
<span class="c1"># 6          West     Northeast 54.5 1.000000000   </span>
<span class="c1"># ---</span>
<span class="c1"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>


<span class="nf">plot</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;lightblue&#34;</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="s">&#34;Multiple Comparisons&#34;</span><span class="p">,</span>
     <span class="n">xlab</span><span class="o">=</span><span class="s">&#34;US Region&#34;</span><span class="p">,</span>
     <span class="n">ylab</span><span class="o">=</span><span class="s">&#34;Healthy Life Expectancy (years) at Age 65&#34;</span><span class="p">)</span>


<span class="c1">#==========================================================</span>
<span class="c1"># 21.2.1. Computing the statistics</span>
<span class="c1"># code listing 21.2. Contents of the oneway.R file</span>

<span class="c1">#&#39; @title Nonparametric group comparisons</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @description</span>
<span class="c1">#&#39; \code{oneway} computes nonparametric group comparisons, including an</span>
<span class="c1">#&#39; omnibus test and post-hoc pairwise group comparisons.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @details</span>
<span class="c1">#&#39; This function computes an omnibus Kruskal-Wallis test that the</span>
<span class="c1">#&#39; groups are equal, followed by all pairwise comparisons using</span>
<span class="c1">#&#39; Wilcoxon Rank Sum tests. Exact Wilcoxon tests can be requested if</span>
<span class="c1">#&#39; there are no ties on the dependent variable. The p-values are</span>
<span class="c1">#&#39; adjusted for multiple comparisons using the \code{\link{p.adjust}}</span>
<span class="c1">#&#39; function.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @param formula an object of class formula, relating the dependent</span>
<span class="c1">#&#39; variable to the grouping variable.</span>
<span class="c1">#&#39; @param data a data frame containing the variables in the model.</span>
<span class="c1">#&#39; @param exact logical. If \code{TRUE}, calculate exact Wilcoxon tests.</span>
<span class="c1">#&#39; @param sort logical. If \code{TRUE}, sort groups by median dependent</span>
<span class="c1">#&#39; variable values.</span>
<span class="c1">#&#39; @param method method for correcting p-values for multiple comparisons.</span>
<span class="c1">#&#39; @export</span>
<span class="c1">#&#39; @return a list with 7 elements:</span>
<span class="c1">#&#39; \item{CALL}{function call}</span>
<span class="c1">#&#39; \item{data}{data frame containing the depending and grouping variable}</span>
<span class="c1">#&#39; \item{sumstats}{data frame with descriptive statistics by group}</span>
<span class="c1">#&#39; \item{kw}{results of the Kruskal-Wallis test}</span>
<span class="c1">#&#39; \item{method}{method used to adjust p-values}</span>
<span class="c1">#&#39; \item{wmc}{data frame containing the multiple comparisons}</span>
<span class="c1">#&#39; \item{vnames}{variable names}</span>
<span class="c1">#&#39; @author Rob Kabacoff &lt;rkabacoff@@statmethods.net&gt;</span>
<span class="c1">#&#39; @examples</span>
<span class="c1">#&#39; results &lt;- oneway(hlef ~ region, life)</span>
<span class="c1">#&#39; summary(results)</span>
<span class="c1">#&#39; plot(results, col=&#34;lightblue&#34;, main=&#34;Multiple Comparisons&#34;,</span>
<span class="c1">#&#39;      xlab=&#34;US Region&#34;, ylab=&#34;Healthy Life Expectancy at Age 65&#34;)</span>

<span class="c1"># 1. Function call</span>
<span class="n">oneway</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span>	
                   <span class="n">method</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;holm&#34;</span><span class="p">,</span> <span class="s">&#34;hochberg&#34;</span><span class="p">,</span> <span class="s">&#34;hommel&#34;</span><span class="p">,</span> <span class="s">&#34;bonferroni&#34;</span><span class="p">,</span>	
                            <span class="s">&#34;BH&#34;</span><span class="p">,</span> <span class="s">&#34;BY&#34;</span><span class="p">,</span> <span class="s">&#34;fdr&#34;</span><span class="p">,</span> <span class="s">&#34;none&#34;</span><span class="p">)){</span>	
  
  <span class="c1"># 2. Checks arguments</span>
  <span class="nf">if </span><span class="p">(</span><span class="nf">missing</span><span class="p">(</span><span class="n">formula</span><span class="p">)</span> <span class="o">||</span> <span class="nf">class</span><span class="p">(</span><span class="n">formula</span><span class="p">)</span> <span class="o">!=</span> <span class="s">&#34;formula&#34;</span> <span class="o">||</span>	
      <span class="nf">length</span><span class="p">(</span><span class="nf">all.vars</span><span class="p">(</span><span class="n">formula</span><span class="p">))</span> <span class="o">!=</span> <span class="m">2</span><span class="p">)</span>	
    <span class="nf">stop</span><span class="p">(</span><span class="s">&#34;&#39;formula&#39; is missing or incorrect&#34;</span><span class="p">)</span>	
  
  <span class="n">method</span> <span class="o">&lt;-</span> <span class="nf">match.arg</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>	
  
  <span class="c1"># 3. Sets up data</span>
  <span class="n">df</span> <span class="o">&lt;-</span> <span class="nf">model.frame</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>	
  <span class="n">y</span> <span class="o">&lt;-</span> <span class="n">df[[1]]</span>	
  <span class="n">g</span> <span class="o">&lt;-</span> <span class="nf">as.factor</span><span class="p">(</span><span class="n">df[[2]]</span><span class="p">)</span>	
  <span class="n">vnames</span> <span class="o">&lt;-</span> <span class="nf">names</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>	
  
  <span class="c1"># 4. Reorders factor levels</span>
  <span class="nf">if</span><span class="p">(</span><span class="n">sort</span><span class="p">)</span> <span class="n">g</span> <span class="o">&lt;-</span> <span class="nf">reorder</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">FUN</span><span class="o">=</span><span class="n">median</span><span class="p">)</span>	
  <span class="n">groups</span> <span class="o">&lt;-</span> <span class="nf">levels</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
  <span class="n">k</span> <span class="o">&lt;-</span> <span class="nf">nlevels</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
  
  <span class="c1"># 5. Summary statistics</span>
  <span class="n">getstats</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)(</span><span class="nf">c</span><span class="p">(</span><span class="n">N</span> <span class="o">=</span> <span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Median</span> <span class="o">=</span> <span class="nf">median</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>	
                            <span class="n">MAD</span> <span class="o">=</span> <span class="nf">mad</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>	
  <span class="n">sumstats</span> <span class="o">&lt;-</span> <span class="nf">t</span><span class="p">(</span><span class="nf">aggregate</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="n">FUN</span><span class="o">=</span><span class="n">getstats</span><span class="p">)</span><span class="n">[2]</span><span class="p">)</span>	
  <span class="nf">rownames</span><span class="p">(</span><span class="n">sumstats</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;n&#34;</span><span class="p">,</span> <span class="s">&#34;median&#34;</span><span class="p">,</span> <span class="s">&#34;mad&#34;</span><span class="p">)</span>	
  <span class="nf">colnames</span><span class="p">(</span><span class="n">sumstats</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">groups</span>	
  
  <span class="c1"># 6. Statistical tests</span>
  <span class="n">kw</span> <span class="o">&lt;-</span> <span class="nf">kruskal.test</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>	
  <span class="n">wmc</span> <span class="o">&lt;-</span> <span class="kc">NULL</span>	
  <span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="p">(</span><span class="n">k</span><span class="m">-1</span><span class="p">)){</span>	
    <span class="nf">for </span><span class="p">(</span><span class="n">j</span> <span class="nf">in </span><span class="p">(</span><span class="n">i</span><span class="m">+1</span><span class="p">)</span><span class="o">:</span><span class="n">k</span><span class="p">){</span>	
      <span class="n">y1</span> <span class="o">&lt;-</span> <span class="n">y[g</span><span class="o">==</span><span class="n">groups[i]]</span>	
      <span class="n">y2</span> <span class="o">&lt;-</span> <span class="n">y[g</span><span class="o">==</span><span class="n">groups[j]]</span>	
      <span class="n">test</span> <span class="o">&lt;-</span> <span class="nf">wilcox.test</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="n">exact</span><span class="p">)</span>	
      <span class="n">r</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">Group.1</span><span class="o">=</span><span class="n">groups[i]</span><span class="p">,</span> <span class="n">Group.2</span><span class="o">=</span><span class="n">groups[j]</span><span class="p">,</span>	
                      <span class="n">W</span><span class="o">=</span><span class="n">test</span><span class="o">$</span><span class="n">statistic[[1]]</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">test</span><span class="o">$</span><span class="n">p.value</span><span class="p">)</span>	
      <span class="c1"># note the [[]] to return a single number	</span>
      <span class="n">wmc</span> <span class="o">&lt;-</span> <span class="nf">rbind</span><span class="p">(</span><span class="n">wmc</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>	
    <span class="p">}</span>	
  <span class="p">}</span>	
  <span class="n">wmc</span><span class="o">$</span><span class="n">p</span> <span class="o">&lt;-</span> <span class="nf">p.adjust</span><span class="p">(</span><span class="n">wmc</span><span class="o">$</span><span class="n">p</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>	
  
  <span class="c1"># 7.Return results</span>
  <span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>	
  <span class="nf">names</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">vnames</span>	
  <span class="n">results</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span><span class="n">CALL</span> <span class="o">=</span> <span class="nf">match.call</span><span class="p">(),</span>	
                  <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>	
                  <span class="n">sumstats</span><span class="o">=</span><span class="n">sumstats</span><span class="p">,</span> <span class="n">kw</span><span class="o">=</span><span class="n">kw</span><span class="p">,</span>	
                  <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">wmc</span><span class="o">=</span><span class="n">wmc</span><span class="p">,</span> <span class="n">vnames</span><span class="o">=</span><span class="n">vnames</span><span class="p">)</span>	
  <span class="nf">class</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;oneway&#34;</span><span class="p">,</span> <span class="s">&#34;list&#34;</span><span class="p">)</span>	
  <span class="nf">return</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>	
<span class="p">}</span>


<span class="c1"># 21.2.2. Printing the results</span>
<span class="nf">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="c1"># data: hlef by region </span>
<span class="c1"># </span>
<span class="c1"># Multiple Comparisons (Wilcoxon Rank Sum Tests)</span>
<span class="c1"># Probability Adjustment = holm</span>
<span class="c1">#         Group.1       Group.2    W           p</span>
<span class="c1"># 1         South North Central 28.0 0.008583179</span>
<span class="c1"># 2         South          West 27.0 0.004737844</span>
<span class="c1"># 3         South     Northeast 17.0 0.008583179</span>
<span class="c1"># 4 North Central          West 63.5 1.000000000</span>
<span class="c1"># 5 North Central     Northeast 42.0 1.000000000</span>
<span class="c1"># 6          West     Northeast 54.5 1.000000000</span>


<span class="c1"># code listing 21.3. Contents of the print.R file</span>
<span class="c1">#&#39; @title Print multiple comparisons</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @description</span>
<span class="c1">#&#39; \code{print.oneway} prints pairwise group comparisons.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @details</span>
<span class="c1">#&#39; This function prints Wilcoxon pairwise multiple comparisons created</span>
<span class="c1">#&#39; by the \code{\link{oneway}} function.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @param x an object of class \code{oneway}.</span>
<span class="c1">#&#39; @param ... additional arguments passed to the function.</span>
<span class="c1">#&#39; @method print oneway</span>
<span class="c1">#&#39; @export</span>
<span class="c1">#&#39; @return the input object is returned silently.</span>
<span class="c1">#&#39; @author Rob Kabacoff &lt;rkabacoff@@statmethods.net&gt;</span>
<span class="c1">#&#39; @examples</span>
<span class="c1">#&#39; results &lt;- oneway(hlef ~ region, life)</span>
<span class="c1">#&#39; print(results)</span>
<span class="n">print.oneway</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="kc">...</span><span class="p">){</span>
  <span class="c1"># 1. Checks input</span>
  <span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">inherits</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#34;oneway&#34;</span><span class="p">))</span>	
    <span class="nf">stop</span><span class="p">(</span><span class="s">&#34;Object must be of class &#39;oneway&#39;&#34;</span><span class="p">)</span>	
  
  <span class="c1"># 2.Print the header</span>
  <span class="nf">cat</span><span class="p">(</span><span class="s">&#34;data:&#34;</span><span class="p">,</span> <span class="n">x</span><span class="o">$</span><span class="n">vnames[1]</span><span class="p">,</span> <span class="s">&#34;by&#34;</span><span class="p">,</span> <span class="n">x</span><span class="o">$</span><span class="n">vnames[2]</span><span class="p">,</span> <span class="s">&#34;\n\n&#34;</span><span class="p">)</span>	
  <span class="nf">cat</span><span class="p">(</span><span class="s">&#34;Multiple Comparisons (Wilcoxon Rank Sum Tests)\n&#34;</span><span class="p">)</span>	
  <span class="nf">cat</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;Probability Adjustment = &#34;</span><span class="p">,</span> <span class="n">x</span><span class="o">$</span><span class="n">method</span><span class="p">,</span> <span class="s">&#34;\n&#34;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">))</span>	
  
  <span class="c1"># 3. print the table</span>
  <span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="o">$</span><span class="n">wmc</span><span class="p">,</span>  <span class="kc">...</span><span class="p">)</span>	
<span class="p">}</span>



<span class="c1"># 21.2.3. Summarizing the results</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># code lisitng 21.4. Contents of the summary.R file</span>
<span class="c1">#&#39; @title Summarize oneway nonparametric analyses</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @description</span>
<span class="c1">#&#39; \code{summary.oneway} summarizes the results of a oneway</span>
<span class="c1">#&#39; nonparametric analysis.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @details</span>
<span class="c1">#&#39; This function prints a summary of analyses produced by</span>
<span class="c1">#&#39; the \code{\link{oneway}} function. This includes descriptive</span>
<span class="c1">#&#39; statistics by group, an omnibus Kruskal-Wallis test, and</span>
<span class="c1">#&#39; Wilcoxon pairwise multiple comparisons.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @param object an object of class \code{oneway}.</span>
<span class="c1">#&#39; @param ... additional parameters.</span>
<span class="c1">#&#39; @method summary oneway</span>
<span class="c1">#&#39; @export</span>
<span class="c1">#&#39; @return the input object is returned silently.</span>
<span class="c1">#&#39; @author Rob Kabacoff &lt;rkabacoff@@statmethods.net&gt;</span>
<span class="c1">#&#39; @examples</span>
<span class="c1">#&#39; results &lt;- oneway(hlef ~ region, life)</span>
<span class="c1">#&#39; summary(results)</span>
<span class="n">summary.oneway</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">object</span><span class="p">,</span> <span class="kc">...</span><span class="p">){</span>
  <span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">inherits</span><span class="p">(</span><span class="n">object</span><span class="p">,</span> <span class="s">&#34;oneway&#34;</span><span class="p">))</span>
    <span class="nf">stop</span><span class="p">(</span><span class="s">&#34;Object must be of class &#39;oneway&#39;&#34;</span><span class="p">)</span>
  
  <span class="nf">if</span><span class="p">(</span><span class="o">!</span><span class="nf">exists</span><span class="p">(</span><span class="s">&#34;digits&#34;</span><span class="p">))</span> <span class="n">digits</span> <span class="o">&lt;-</span> <span class="m">4L</span>
  
  <span class="n">kw</span> <span class="o">&lt;-</span> <span class="n">object</span><span class="o">$</span><span class="n">kw</span>
  <span class="n">wmc</span> <span class="o">&lt;-</span> <span class="n">object</span><span class="o">$</span><span class="n">wmc</span>
  <span class="nf">cat</span><span class="p">(</span><span class="s">&#34;data:&#34;</span><span class="p">,</span> <span class="n">object</span><span class="o">$</span><span class="n">vnames[1]</span><span class="p">,</span> <span class="s">&#34;on&#34;</span><span class="p">,</span> <span class="n">object</span><span class="o">$</span><span class="n">vnames[2]</span><span class="p">,</span> <span class="s">&#34;\n\n&#34;</span><span class="p">)</span>
  
  
  <span class="c1"># Kruskal-Wallis test</span>
  <span class="nf">cat</span><span class="p">(</span><span class="s">&#34;Omnibus Test\n&#34;</span><span class="p">)</span>	
  <span class="nf">cat</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;Kruskal-Wallis chi-squared = &#34;</span><span class="p">,</span>	
            <span class="nf">round</span><span class="p">(</span><span class="n">kw</span><span class="o">$</span><span class="n">statistic</span><span class="p">,</span><span class="m">4</span><span class="p">),</span>	
            <span class="s">&#34;, df = &#34;</span><span class="p">,</span> <span class="nf">round</span><span class="p">(</span><span class="n">kw</span><span class="o">$</span><span class="n">parameter</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span>	
            <span class="s">&#34;, p-value = &#34;</span><span class="p">,</span>	
            <span class="nf">format.pval</span><span class="p">(</span><span class="n">kw</span><span class="o">$</span><span class="n">p.value</span><span class="p">,</span> <span class="n">digits</span> <span class="o">=</span> <span class="n">digits</span><span class="p">),</span>	
            <span class="s">&#34;\n\n&#34;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">))</span>	
  
  <span class="c1"># Descriptive Statistics</span>
  <span class="nf">cat</span><span class="p">(</span><span class="s">&#34;Descriptive Statistics\n&#34;</span><span class="p">)</span>	
  <span class="nf">print</span><span class="p">(</span><span class="n">object</span><span class="o">$</span><span class="n">sumstats</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span>	
  
  <span class="c1"># Table annotation</span>
  <span class="n">wmc</span><span class="o">$</span><span class="n">stars</span> <span class="o">&lt;-</span> <span class="s">&#34; &#34;</span>	
  <span class="n">wmc</span><span class="o">$</span><span class="n">stars[wmc</span><span class="o">$</span><span class="n">p</span> <span class="o">&lt;</span>   <span class="m">.1</span><span class="n">]</span> <span class="o">&lt;-</span> <span class="s">&#34;.&#34;</span>	
  <span class="n">wmc</span><span class="o">$</span><span class="n">stars[wmc</span><span class="o">$</span><span class="n">p</span> <span class="o">&lt;</span>  <span class="m">.05</span><span class="n">]</span> <span class="o">&lt;-</span> <span class="s">&#34;*&#34;</span>	
  <span class="n">wmc</span><span class="o">$</span><span class="n">stars[wmc</span><span class="o">$</span><span class="n">p</span> <span class="o">&lt;</span>  <span class="m">.01</span><span class="n">]</span> <span class="o">&lt;-</span> <span class="s">&#34;**&#34;</span>	
  <span class="n">wmc</span><span class="o">$</span><span class="n">stars[wmc</span><span class="o">$</span><span class="n">p</span> <span class="o">&lt;</span> <span class="m">.001</span><span class="n">]</span> <span class="o">&lt;-</span> <span class="s">&#34;***&#34;</span>	
  <span class="nf">names</span><span class="p">(</span><span class="n">wmc</span><span class="p">)</span><span class="nf">[which</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">wmc</span><span class="p">)</span><span class="o">==</span><span class="s">&#34;stars&#34;</span><span class="p">)</span><span class="n">]</span> <span class="o">&lt;-</span> <span class="s">&#34; &#34;</span>	
  
  <span class="c1"># Pairwise multiple comparisons</span>
  <span class="nf">cat</span><span class="p">(</span><span class="s">&#34;\nMultiple Comparisons (Wilcoxon Rank Sum Tests)\n&#34;</span><span class="p">)</span>	
  <span class="nf">cat</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;Probability Adjustment = &#34;</span><span class="p">,</span> <span class="n">object</span><span class="o">$</span><span class="n">method</span><span class="p">,</span> <span class="s">&#34;\n&#34;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">))</span>	
  <span class="nf">print</span><span class="p">(</span><span class="n">wmc</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span>	
  <span class="nf">cat</span><span class="p">(</span><span class="s">&#34;---\nSignif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39;	
</span><span class="s">     1\n&#34;</span><span class="p">)</span>	
<span class="p">}</span>


<span class="c1"># 21.2.4. Plotting the results</span>
<span class="c1"># code listing 21.5. Contents of the plot.R file</span>
<span class="c1">#&#39; @title Plot nonparametric group comparisons</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @description</span>
<span class="c1">#&#39; \code{plot.oneway} plots nonparametric group comparisons.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @details</span>
<span class="c1">#&#39; This function plots nonparametric group comparisons</span>
<span class="c1">#&#39; created by the \code{\link{oneway}} function using</span>
<span class="c1">#&#39; annotated side by side boxplots. Medians and</span>
<span class="c1">#&#39; sample sizes are placed at the top of the chart.</span>
<span class="c1">#&#39; The overall median is represented by a horizontal</span>
<span class="c1">#&#39; dashed line.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @param x an object of class \code{oneway}.</span>
<span class="c1">#&#39; @param ... additional arguments passed to the</span>
<span class="c1">#&#39; \code{\link{boxplot}} function.</span>
<span class="c1">#&#39; @method plot oneway</span>
<span class="c1">#&#39; @export</span>
<span class="c1">#&#39; @return NULL</span>
<span class="c1">#&#39; @author Rob Kabacoff &lt;rkabacoff@@statmethods.net&gt;</span>
<span class="c1">#&#39; @examples</span>
<span class="c1">#&#39; results &lt;- oneway(hlef ~ region, life)</span>
<span class="c1">#&#39; plot(results, col=&#34;lightblue&#34;, main=&#34;Multiple Comparisons&#34;,</span>
<span class="c1">#&#39;      xlab=&#34;US Region&#34;, ylab=&#34;Healthy Life Expectancy at Age 65&#34;)</span>
<span class="n">plot.oneway</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="kc">...</span><span class="p">){</span>
  
  <span class="c1"># 1. Checks input</span>
  <span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">inherits</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#34;oneway&#34;</span><span class="p">))</span>	
    <span class="nf">stop</span><span class="p">(</span><span class="s">&#34;Object must be of class &#39;oneway&#39;&#34;</span><span class="p">)</span>	
  
  <span class="c1"># 2. Generates the box plots</span>
  <span class="n">data</span> <span class="o">&lt;-</span> <span class="n">x</span><span class="o">$</span><span class="n">data</span>	
  <span class="n">y</span> <span class="o">&lt;-</span> <span class="n">data[</span><span class="p">,</span><span class="m">1</span><span class="n">]</span>	
  <span class="n">g</span> <span class="o">&lt;-</span> <span class="n">data[</span><span class="p">,</span><span class="m">2</span><span class="n">]</span>	
  <span class="n">stats</span> <span class="o">&lt;-</span> <span class="n">x</span><span class="o">$</span><span class="n">sumstats</span>	
  <span class="n">lbl</span> <span class="o">&lt;-</span> <span class="nf">paste</span><span class="p">(</span><span class="s">&#34;md=&#34;</span><span class="p">,</span> <span class="n">stats[2</span><span class="p">,</span><span class="n">]</span><span class="p">,</span> <span class="s">&#34;\nn=&#34;</span><span class="p">,</span> <span class="n">stats[1</span><span class="p">,</span><span class="n">]</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">)</span>	
  <span class="n">opar</span> <span class="o">&lt;-</span> <span class="nf">par</span><span class="p">(</span><span class="n">no.readonly</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>	
  <span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">8</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
  <span class="nf">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">~</span><span class="n">g</span><span class="p">,</span>  <span class="kc">...</span><span class="p">)</span>
  
  <span class="c1"># 3. Annotates the plot</span>
  <span class="nf">abline</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="nf">median</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;darkgrey&#34;</span><span class="p">)</span>	
  <span class="nf">axis</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="n">at</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">lbl</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="n">lbl</span><span class="p">,</span> <span class="n">cex.axis</span><span class="o">=</span><span class="m">.9</span><span class="p">)</span>	
  <span class="nf">par</span><span class="p">(</span><span class="n">opar</span><span class="p">)</span>
<span class="p">}</span>


<span class="c1"># 21.2.5. Adding sample data to the package</span>
<span class="c1"># code listing 21.6. Creating the life data frame</span>
<span class="n">region</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="s">&#34;North Central&#34;</span><span class="p">,</span> <span class="m">12</span><span class="p">),</span> <span class="nf">rep</span><span class="p">(</span><span class="s">&#34;Northeast&#34;</span><span class="p">,</span> <span class="m">9</span><span class="p">),</span>
            <span class="nf">rep</span><span class="p">(</span><span class="s">&#34;South&#34;</span><span class="p">,</span> <span class="m">16</span><span class="p">),</span> <span class="nf">rep</span><span class="p">(</span><span class="s">&#34;West&#34;</span><span class="p">,</span> <span class="m">13</span><span class="p">))</span>

<span class="n">state</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;IL&#34;</span><span class="p">,</span><span class="s">&#34;IN&#34;</span><span class="p">,</span><span class="s">&#34;IA&#34;</span><span class="p">,</span><span class="s">&#34;KS&#34;</span><span class="p">,</span><span class="s">&#34;MI&#34;</span><span class="p">,</span><span class="s">&#34;MN&#34;</span><span class="p">,</span><span class="s">&#34;MO&#34;</span><span class="p">,</span><span class="s">&#34;NE&#34;</span><span class="p">,</span><span class="s">&#34;ND&#34;</span><span class="p">,</span><span class="s">&#34;OH&#34;</span><span class="p">,</span><span class="s">&#34;SD&#34;</span><span class="p">,</span><span class="s">&#34;WI&#34;</span><span class="p">,</span>
           <span class="s">&#34;CT&#34;</span><span class="p">,</span><span class="s">&#34;ME&#34;</span><span class="p">,</span><span class="s">&#34;MA&#34;</span><span class="p">,</span><span class="s">&#34;NH&#34;</span><span class="p">,</span><span class="s">&#34;NJ&#34;</span><span class="p">,</span><span class="s">&#34;NY&#34;</span><span class="p">,</span><span class="s">&#34;PA&#34;</span><span class="p">,</span><span class="s">&#34;RI&#34;</span><span class="p">,</span><span class="s">&#34;VT&#34;</span><span class="p">,</span><span class="s">&#34;AL&#34;</span><span class="p">,</span><span class="s">&#34;AR&#34;</span><span class="p">,</span><span class="s">&#34;DE&#34;</span><span class="p">,</span>
           <span class="s">&#34;FL&#34;</span><span class="p">,</span><span class="s">&#34;GA&#34;</span><span class="p">,</span><span class="s">&#34;KY&#34;</span><span class="p">,</span><span class="s">&#34;LA&#34;</span><span class="p">,</span><span class="s">&#34;MD&#34;</span><span class="p">,</span><span class="s">&#34;MS&#34;</span><span class="p">,</span><span class="s">&#34;NC&#34;</span><span class="p">,</span><span class="s">&#34;OK&#34;</span><span class="p">,</span><span class="s">&#34;SC&#34;</span><span class="p">,</span><span class="s">&#34;TN&#34;</span><span class="p">,</span><span class="s">&#34;TX&#34;</span><span class="p">,</span><span class="s">&#34;VA&#34;</span><span class="p">,</span>
           <span class="s">&#34;WV&#34;</span><span class="p">,</span><span class="s">&#34;AK&#34;</span><span class="p">,</span><span class="s">&#34;AZ&#34;</span><span class="p">,</span><span class="s">&#34;CA&#34;</span><span class="p">,</span><span class="s">&#34;CO&#34;</span><span class="p">,</span><span class="s">&#34;HI&#34;</span><span class="p">,</span><span class="s">&#34;ID&#34;</span><span class="p">,</span><span class="s">&#34;MT&#34;</span><span class="p">,</span><span class="s">&#34;NV&#34;</span><span class="p">,</span><span class="s">&#34;NM&#34;</span><span class="p">,</span><span class="s">&#34;OR&#34;</span><span class="p">,</span><span class="s">&#34;UT&#34;</span><span class="p">,</span>
           <span class="s">&#34;WA&#34;</span><span class="p">,</span><span class="s">&#34;WY&#34;</span><span class="p">)</span>
<span class="n">hlem</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">12.6</span><span class="p">,</span><span class="m">12.2</span><span class="p">,</span><span class="m">13.4</span><span class="p">,</span><span class="m">13.1</span><span class="p">,</span><span class="m">12.8</span><span class="p">,</span><span class="m">14.3</span><span class="p">,</span><span class="m">11.7</span><span class="p">,</span><span class="m">13.1</span><span class="p">,</span><span class="m">12.9</span><span class="p">,</span><span class="m">12.2</span><span class="p">,</span><span class="m">13.3</span><span class="p">,</span><span class="m">13.4</span><span class="p">,</span>
          <span class="m">14.3</span><span class="p">,</span><span class="m">13.5</span><span class="p">,</span><span class="m">13.8</span><span class="p">,</span><span class="m">14</span><span class="p">,</span><span class="m">12.9</span><span class="p">,</span><span class="m">13.6</span><span class="p">,</span><span class="m">12.8</span><span class="p">,</span><span class="m">13.1</span><span class="p">,</span><span class="m">13.9</span><span class="p">,</span><span class="m">10.3</span><span class="p">,</span><span class="m">11.6</span><span class="p">,</span><span class="m">13.5</span><span class="p">,</span>
          <span class="m">14.3</span><span class="p">,</span><span class="m">11.6</span><span class="p">,</span><span class="m">10.2</span><span class="p">,</span><span class="m">11.6</span><span class="p">,</span><span class="m">13.3</span><span class="p">,</span><span class="m">10.1</span><span class="p">,</span><span class="m">11.7</span><span class="p">,</span><span class="m">10.8</span><span class="p">,</span><span class="m">12</span><span class="p">,</span><span class="m">11.2</span><span class="p">,</span><span class="m">12.2</span><span class="p">,</span><span class="m">13.3</span><span class="p">,</span>
          <span class="m">10.3</span><span class="p">,</span><span class="m">13.3</span><span class="p">,</span><span class="m">13.7</span><span class="p">,</span><span class="m">13.8</span><span class="p">,</span><span class="m">14.3</span><span class="p">,</span><span class="m">15</span><span class="p">,</span><span class="m">13.1</span><span class="p">,</span><span class="m">13.4</span><span class="p">,</span><span class="m">12.8</span><span class="p">,</span><span class="m">13.1</span><span class="p">,</span><span class="m">13.9</span><span class="p">,</span><span class="m">14.3</span><span class="p">,</span><span class="m">14</span><span class="p">,</span>
          <span class="m">13.7</span><span class="p">)</span>
<span class="n">hlef</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">14.3</span><span class="p">,</span><span class="m">14.1</span><span class="p">,</span><span class="m">15.9</span><span class="p">,</span><span class="m">15.1</span><span class="p">,</span><span class="m">14.7</span><span class="p">,</span><span class="m">16.7</span><span class="p">,</span><span class="m">14</span><span class="p">,</span><span class="m">15.7</span><span class="p">,</span><span class="m">16</span><span class="p">,</span><span class="m">14</span><span class="p">,</span><span class="m">16.4</span><span class="p">,</span><span class="m">16.1</span><span class="p">,</span><span class="m">16.7</span><span class="p">,</span>
          <span class="m">15.7</span><span class="p">,</span><span class="m">15.9</span><span class="p">,</span><span class="m">16</span><span class="p">,</span><span class="m">14.8</span><span class="p">,</span><span class="m">15.3</span><span class="p">,</span><span class="m">14.8</span><span class="p">,</span><span class="m">15.6</span><span class="p">,</span><span class="m">16.2</span><span class="p">,</span><span class="m">11.7</span><span class="p">,</span><span class="m">12.7</span><span class="p">,</span><span class="m">15.7</span><span class="p">,</span><span class="m">16.4</span><span class="p">,</span>
          <span class="m">13.1</span><span class="p">,</span><span class="m">11.6</span><span class="p">,</span><span class="m">12.3</span><span class="p">,</span><span class="m">15.3</span><span class="p">,</span><span class="m">11.4</span><span class="p">,</span><span class="m">13.5</span><span class="p">,</span><span class="m">12.9</span><span class="p">,</span><span class="m">13.6</span><span class="p">,</span><span class="m">12.5</span><span class="p">,</span><span class="m">13.4</span><span class="p">,</span><span class="m">14.9</span><span class="p">,</span><span class="m">11.6</span><span class="p">,</span>
          <span class="m">14.9</span><span class="p">,</span><span class="m">16.3</span><span class="p">,</span><span class="m">15.5</span><span class="p">,</span><span class="m">16.2</span><span class="p">,</span><span class="m">17.3</span><span class="p">,</span><span class="m">15.1</span><span class="p">,</span><span class="m">15.6</span><span class="p">,</span><span class="m">14.5</span><span class="p">,</span><span class="m">14.7</span><span class="p">,</span><span class="m">16</span><span class="p">,</span><span class="m">15.7</span><span class="p">,</span><span class="m">16</span><span class="p">,</span><span class="m">15.2</span><span class="p">)</span>

<span class="n">life</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="nf">factor</span><span class="p">(</span><span class="n">region</span><span class="p">),</span> <span class="n">state</span><span class="o">=</span><span class="nf">factor</span><span class="p">(</span><span class="n">state</span><span class="p">),</span> <span class="n">hlem</span><span class="p">,</span> <span class="n">hlef</span><span class="p">)</span>

<span class="nf">save</span><span class="p">(</span><span class="n">life</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="s">&#39;life.rda&#39;</span><span class="p">)</span>


<span class="c1"># code listing 21.7. Contents of the life.R file</span>
<span class="c1">#&#39; @title Healthy Life Expectancy at Age 65</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @description A dataset containing the healthy life expectancy (expected</span>
<span class="c1">#&#39; years of life in good health) at age 65, by US state in 2007-2009.</span>
<span class="c1">#&#39; Estimates are reported separately for men and women.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @docType data</span>
<span class="c1">#&#39; @keywords datasets</span>
<span class="c1">#&#39; @name life</span>
<span class="c1">#&#39; @usage life</span>
<span class="c1">#&#39; @format A data frame with 50 rows and 4 variables. The variables</span>
<span class="c1">#&#39; are as follows:</span>
<span class="c1">#&#39; \describe{</span>
<span class="c1">#&#39;   \item{region}{A factor with 4 levels (North Central, Northeast,</span>
<span class="c1">#&#39;                 South, West)}</span>
<span class="c1">#&#39;   \item{state}{A factor with the 2-letter ISO codes for the 50 US</span>
<span class="c1">#&#39;                states}</span>
<span class="c1">#&#39;   \item{hlem}{Healthy life expectancy for men in years}</span>
<span class="c1">#&#39;   \item{hlef}{Healthy life expectancy for women in years}</span>
<span class="c1">#&#39; }</span>
<span class="c1">#&#39; @source The \code{hlem} and \code{hlef} data were obtained from</span>
<span class="c1">#&#39; the Center for Disease Control and Prevention</span>
<span class="c1">#&#39; \emph{Morbidity and Mortality Weekly Report} at \url{</span>
<span class="c1">#&#39; http://www.cdc.gov/mmwr/preview/mmwrhtml/mm6228a1.htm?s_cid=mm6228a1_w}.</span>
<span class="c1">#&#39; The \code{region} variable was added from the</span>
<span class="c1">#&#39; \code{\link[datasets]{state.region}} dataset.</span>
<span class="kc">NULL</span>


<span class="c1"># 21.3. Creating the package documentation</span>
<span class="c1"># code listing 21.8. Contents of the npar.R file</span>
<span class="c1">#&#39; Functions for nonparametric group comparisons.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; npar provides tools for calculating and visualizing</span>
<span class="c1">#&#39; nonparametric differences among groups.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @docType package</span>
<span class="c1">#&#39; @name npar-package</span>
<span class="c1">#&#39; @aliases npar</span>
<span class="kc">NULL</span>

<span class="c1">#... this file must end with a blank line after the NULL...</span>
</code></pre></td></tr></table>
</div>
</div>
    </div>

    
    


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://xiaonilee.github.io/tags/r/">R</a>
          <a href="https://xiaonilee.github.io/tags/r-in-action/">R in Action</a>
          <a href="https://xiaonilee.github.io/tags/bioinformatics/">Bioinformatics</a>
          <a href="https://xiaonilee.github.io/tags/book/">Book</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/rinaction22/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">Chapter 22. Creating dynamic reports</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="/post/rinaction20/">
            <span class="next-text nav-default">Chapter 20. Advanced programming</span>
            <span class="prev-text nav-mobile">Next</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:xiaoni0601@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/xiaonilee" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="https://xiaonilee.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">

  <span class="copyright-year">
    &copy;
    2020
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        xiaonilee
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>



  <script type="text/javascript">
    window.MathJax = {
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script>









  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  















</body>
</html>
